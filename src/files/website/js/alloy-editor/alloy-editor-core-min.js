CKEDITOR.disableAutoInline=!0,function(){window.AlloyEditor||(!function(){"use strict";CKEDITOR.tools.debounce=CKEDITOR.tools.debounce||function(t,e,o,n){var i,r=function(){var r=o||this;clearTimeout(i);for(var a=[],s=arguments.length,l=0;s>l;++l)a.push(arguments[l]);var c=a.concat(n||[]);i=setTimeout(function(){t.apply(r,c)},e)};return r.detach=function(){clearTimeout(i)},r}}(),function(){"use strict";function t(t){this._editor=t}t.prototype={constructor:t,create:function(t,e){var o=this._editor.getSelection(),n=o.getRanges()[0];if(n.collapsed){var i=new CKEDITOR.dom.text(t,this._editor.document);n.insertNode(i),n.selectNodeContents(i)}var r=CKEDITOR.tools.merge({"data-cke-saved-href":t,href:t},e),a=new CKEDITOR.style({attributes:r,element:"a"});a.type=CKEDITOR.STYLE_INLINE,a.applyToRange(n,this._editor),n.select()},getFromSelection:function(){var t=this._editor.getSelection(),e=t.getSelectedElement();if(e&&e.is("a"))return e;var o=t.getRanges()[0];return o?(o.shrink(CKEDITOR.SHRINK_TEXT),this._editor.elementPath(o.getCommonAncestor()).contains("a",1)):null},remove:function(t){var e=this._editor;if(t)t.remove(e);else{var o=t||new CKEDITOR.style({alwaysRemoveElement:1,element:"a",type:CKEDITOR.STYLE_INLINE}),n=e.getSelection();n.selectElement(n.getStartElement()),e.removeStyle(o)}},update:function(t,e){var o=e||this.getFromSelection();o.setAttributes({"data-cke-saved-href":t,href:t})}},CKEDITOR.Link=CKEDITOR.Link||t}(),function(){"use strict";function t(){}CKEDITOR.plugins.get("selectionregion")||(CKEDITOR.SELECTION_TOP_TO_BOTTOM=0,CKEDITOR.SELECTION_BOTTOM_TO_TOP=1,CKEDITOR.SELECTION_LEFT_TO_RIGHT=2,CKEDITOR.SELECTION_RIGHT_TO_LEFT=3,t.prototype={constructor:t,createSelectionFromPoint:function(t,e){this.createSelectionFromRange(t,e,t,e)},createSelectionFromRange:function(t,e,o,n){var i,r,a,s,l,c,d;if("function"==typeof document.caretPositionFromPoint?(l=document.caretPositionFromPoint(t,e),i=document.caretPositionFromPoint(o,n),c=l.offsetNode,r=i.offsetNode,d=l.offset,a=i.offset,s=this.createRange()):"function"==typeof document.caretRangeFromPoint&&(l=document.caretRangeFromPoint(t,e),i=document.caretRangeFromPoint(o,n),c=l.startContainer,r=i.startContainer,d=l.startOffset,a=i.startOffset,s=this.createRange()),s&&document.getSelection)s.setStart(new CKEDITOR.dom.node(c),d),s.setEnd(new CKEDITOR.dom.node(r),a),this.getSelection().selectRanges([s]);else if("function"==typeof document.body.createTextRange){var u=this.getSelection();u.unlock(),s=document.body.createTextRange(),s.moveToPoint(t,e);var m=s.duplicate();m.moveToPoint(o,n),s.setEndPoint("EndToEnd",m),s.select(),this.getSelection().lock()}},getCaretRegion:function(){var t=this.getSelection(),e=t.createBookmarks(),o=e[0].startNode.$;o.style.display="inline-block";var n=new CKEDITOR.dom.element(o).getClientRect();o.parentNode.removeChild(o);var i=new CKEDITOR.dom.window(window).getScrollPosition();return{bottom:i.y+n.bottom,left:i.x+n.left,right:i.x+n.right,top:i.y+n.top}},getSelectionData:function(){var t=this.getSelection(),e={element:t.getSelectedElement(),text:t.getSelectedText()};return e.region=this.getSelectionRegion(t),e},getSelectionRegion:function(){var t=this.getClientRectsRegion();return t.direction=this.getSelectionDirection(),t.height=t.bottom-t.top,t.width=t.right-t.left,t},isSelectionEmpty:function(){var t,e=this.getSelection();return e.getType()===CKEDITOR.SELECTION_NONE||(t=e.getRanges())&&1===t.length&&t[0].collapsed},getClientRectsRegion:function(){var t,e,o=this.getSelection(),n=o.getNative();if(n.createRange){var i=n.createRange();e=i.getClientRects()}else t=n.rangeCount,e=n.rangeCount>0?n.getRangeAt(0).getClientRects():[];var r,a=0,s=1/0,l=-1/0,c=1/0;if(0===e.length)r=this.getCaretRegion();else{for(var d=0,u=e.length;u>d;d++){var m=e[d];m.left<s&&(s=m.left),m.right>l&&(l=m.right),m.top<c&&(c=m.top),m.bottom>a&&(a=m.bottom)}var p=new CKEDITOR.dom.window(window).getScrollPosition();if(r={bottom:p.y+a,left:p.x+s,right:p.x+l,top:p.y+c},e.length){var h=e[e.length-1],g=e[0];r.endRect={bottom:p.y+h.bottom,height:h.height,left:p.x+h.left,right:p.x+h.right,top:p.y+h.top,width:h.width},r.startRect={bottom:p.y+g.bottom,height:g.height,left:p.x+g.left,right:p.x+g.right,top:p.y+g.top,width:g.width}}}return r},getSelectionDirection:function(){var t,e=this.getSelection(),o=e.getNative(),n=CKEDITOR.SELECTION_TOP_TO_BOTTOM;if((t=o.anchorNode)&&t.compareDocumentPosition){var i=t.compareDocumentPosition(o.focusNode);(!i&&o.anchorOffset>o.focusOffset||i===Node.DOCUMENT_POSITION_PRECEDING)&&(n=CKEDITOR.SELECTION_BOTTOM_TO_TOP)}return n}},CKEDITOR.plugins.add("selectionregion",{init:function(e){var o,n;n=Object.prototype.hasOwnProperty;for(o in t.prototype)n.call(t.prototype,o)&&"undefined"==typeof e[o]&&(e[o]=t.prototype[o])}}))}(),function(){"use strict";function t(t){this._editor=t}t.prototype={constructor:t,create:function(t){for(var e=this._editor,o=this._createElement("table"),n=o.append(this._createElement("tbody")),i=t.rows||1,r=t.cols||1,a=0;i>a;a++)for(var s=n.append(this._createElement("tr")),l=0;r>l;l++){var c=s.append(this._createElement("td"));c.appendBogus()}o.getAttribute("style")||o.removeAttribute("style"),this.setAttributes(o,t.attrs),e.insertElement(o);var d=new CKEDITOR.dom.element(o.$.rows[0].cells[0]),u=e.createRange();return u.moveToPosition(d,CKEDITOR.POSITION_AFTER_START),u.select(),o},getFromSelection:function(){var t,e=this._editor.getSelection(),o=e.getSelectedElement();if(o&&o.is("table"))t=o;else{var n=e.getRanges();n.length>0&&(CKEDITOR.env.webkit&&n[0].shrink(CKEDITOR.NODE_ELEMENT),t=this._editor.elementPath(n[0].getCommonAncestor(!0)).contains("table",1))}return t},remove:function(t){var e=this._editor;if(t)t.remove(e);else if(t=e.elementPath().contains("table",1)){var o=t.getParent(),n=e.editable();1!=o.getChildCount()||o.is("td","th")||o.equals(n)||(t=o);var i=e.createRange();i.moveToPosition(t,CKEDITOR.POSITION_BEFORE_START),t.remove(),i.select()}},setAttributes:function(t,e){Object.keys(e).forEach(function(o){t.setAttribute(o,e[o])})},_createElement:function(t){return new CKEDITOR.dom.element(t,this._editor.document)}},CKEDITOR.Table=CKEDITOR.Table||t}(),function(){"use strict";CKEDITOR.tools.merge=CKEDITOR.tools.merge||function(){for(var t={},e=0;e<arguments.length;++e){var o=arguments[e];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t},CKEDITOR.tools.simulate=function(t,e){var o=document.createEvent("Events");o.initEvent(e,!0,!1),t.dispatchEvent(o)}}(),function(){"use strict";CKEDITOR.plugins.get("uicore")||CKEDITOR.plugins.add("uicore",{init:function(t){var e,o,n,i,r=[];e=this._createAriaElement(t.id),i=t.config.uicore?t.config.uicore.timeout:50,o=CKEDITOR.tools.debounce(function(){e.innerHTML=r.join(". ")},i),n=CKEDITOR.tools.debounce(function(e){r=[],("keyup"!==e.name||27!==e.data.$.keyCode||t.config.allowEsc)&&t.fire("editorInteraction",{nativeEvent:e.data.$,selectionData:t.getSelectionData()})},i),t.on("ariaUpdate",function(t){r.push(t.data.message),o()}),t.on("contentDom",function(){var e=t.editable();e.attachListener(e,"mouseup",n),e.attachListener(e,"keyup",n)}),t.on("destroy",function(){n.detach()})},_createAriaElement:function(t){var e;return e=document.createElement("div"),e.className="sr-only",e.setAttribute("aria-live","polite"),e.setAttribute("role","status"),e.setAttribute("id",t+"LiveRegion"),document.body.appendChild(e),e}})}(),function(){"use strict";if(!CKEDITOR.plugins.get("autolink")){/MSIE ([^;]*)|Trident.*; rv:([0-9.]+)/.test(navigator.userAgent)&&document.execCommand("AutoUrlDetect",!1,!1);var t=8,e=188,o=13,n=186,i=32,r=[e,o,n,i],a=/[^\s]+/gm,s=/(https?\:\/\/|www\.)(-\.)?([^\s/?\.#-]+\.?)+(\/[^\s]*)?$/i;CKEDITOR.plugins.add("autolink",{init:function(t){this._editor=t;var e=t.editable();e.attachListener(e,"keyup",this._onKeyUp,this)},_getLastWord:function(){var t=this._editor.getSelection().getRanges()[0],e=t.startOffset,n="";if(this._currentKeyCode===o){var i,r=t.startContainer.getPrevious();if(r)for(i=r.getLast();i&&!i.getText();)i=i.getPrevious();i&&i.$.href||(this._startContainer=i,n=i?i.getText():"",this._offset=n.length)}else this._startContainer=t.startContainer,n=this._startContainer.getText().substring(0,e-1),this._offset=e-1;var s="",l=n.match(a);return l&&(s=l.pop()),s},_isValidURL:function(t){return s.test(t)},_onKeyDown:function(e){var o=e.data.$,n=this._editor.editable();n.removeListener("keydown",this._onKeyDown),o.keyCode===t&&(e.cancel(),e.data.preventDefault(),this._removeLink()),this._ckLink=null},_onKeyUp:function(t){var e=t.data.$;if(this._currentKeyCode=e.keyCode,-1!==r.indexOf(this._currentKeyCode)){var o=this._getLastWord();this._isValidURL(o)&&this._replaceContentByLink(o)}},_replaceContentByLink:function(t){var e=this._editor.createRange(),n=CKEDITOR.dom.element.get(this._startContainer),i=this._offset;e.setStart(n,i-t.length),e.setEnd(n,i),e.select();var r=new CKEDITOR.Link(this._editor);if(r.create(t),this._ckLink=r,this._subscribeToKeyEvent(),e=this._editor.getSelection().getRanges()[0],this._currentKeyCode===o){var a=e.getNextEditableNode();e.setStart(a,0),e.setEnd(a,0)}else{var s=e.getNextNode();e.setStart(s,1),e.setEnd(s,1)}e.select()},_removeLink:function(){var t=this._editor.getSelection().getRanges()[0],e=t.startOffset,o=this._startContainer.getNext()||this._startContainer,n=this._editor.createRange();n.setStart(o,0),n.setEndAfter(o),n.select(),this._ckLink.remove(),t.setEnd(t.startContainer,e),t.setStart(t.startContainer,e),t.select()},_subscribeToKeyEvent:function(){var t=this._editor.editable();t.attachListener(t,"keydown",this._onKeyDown,this,{},1)}})}}(),function(){"use strict";function t(t){function o(){var e=t.getSelection();e&&(e.getType()!==CKEDITOR.SELECTION_NONE&&e.getStartElement().is("img")?n.event&&n.event.button&&0!==n.event.button||a.show(e.getStartElement().$):a.hide())}var n=t.window.$,i=t.document.$,r="undefined"==typeof c?null:c,a=new e(t,{snapToSize:r});i.addEventListener("mousedown",function(t){a.isHandle(t.target)&&a.initDrag(t)},!1),t.on("selectionChange",o),t.on("getData",function(t){var e=t.data.dataValue||"";e=e.replace(/<div id="ckimgrsz"([\s\S]*?)<\/div>/i,""),e=e.replace(/\b(ckimgrsz)\b/g,""),t.data.dataValue=e}),t.on("beforeUndoImage",function(){a.hide()}),t.on("afterUndoImage",function(){o()}),t.on("blur",function(){a.hide()}),t.on("beforeModeUnload",function l(){t.removeListener("beforeModeUnload",l),a.hide()});var s;t.window.on("resize",function(){clearTimeout(s),s=setTimeout(o,50)})}function e(t,e){this.editor=t,this.window=t.window.$,this.document=t.document.$,this.cfg=e||{},this.init()}function o(t,e){this.window=t,this.document=e,this.events={mousemove:i(this.mousemove,this),keydown:i(this.keydown,this),mouseup:i(this.mouseup,this)}}function n(t){for(var e=t.length,o=new Array(e),n=0;e>n;n++)o[n]=t[n];return o}function i(t,e){return t.bind?t.bind(e):function(){t.apply(e,arguments)}}function r(t,e,o){t.style.left=String(e)+"px",t.style.top=String(o)+"px"}function a(t,e,o){t.style.width=String(e)+"px",t.style.height=String(o)+"px"}function s(t,e){var o=e.getBoundingClientRect();return{left:o.left+t.pageXOffset,top:o.top+t.pageYOffset,width:o.width,height:o.height}}var l="dragresize",c=7,d="WebkitAppearance"in document.documentElement.style;d&&CKEDITOR.addCss("img::selection{color:rgba(0,0,0,0)}img.ckimgrsz{outline:1px dashed #000}#ckimgrsz{position:absolute;width:0;height:0;cursor:default;z-index:10001}#ckimgrsz span{display:none;position:absolute;top:0;left:0;width:0;height:0;background-size:100% 100%;opacity:.65;outline:1px dashed #000}#ckimgrsz i{position:absolute;display:block;width:5px;height:5px;background:#fff;border:1px solid #000}#ckimgrsz i.active,#ckimgrsz i:hover{background:#000}#ckimgrsz i.br,#ckimgrsz i.tl{cursor:nwse-resize}#ckimgrsz i.bm,#ckimgrsz i.tm{cursor:ns-resize}#ckimgrsz i.bl,#ckimgrsz i.tr{cursor:nesw-resize}#ckimgrsz i.lm,#ckimgrsz i.rm{cursor:ew-resize}body.dragging-br,body.dragging-br *,body.dragging-tl,body.dragging-tl *{cursor:nwse-resize!important}body.dragging-bm,body.dragging-bm *,body.dragging-tm,body.dragging-tm *{cursor:ns-resize!important}body.dragging-bl,body.dragging-bl *,body.dragging-tr,body.dragging-tr *{cursor:nesw-resize!important}body.dragging-lm,body.dragging-lm *,body.dragging-rm,body.dragging-rm *{cursor:ew-resize!important}"),CKEDITOR.plugins.add(l,{onLoad:function(){},init:function(e){d&&e.on("contentDom",function(){t(e)})}}),e.prototype={init:function(){var t=this.container=this.document.createElement("div");t.id="ckimgrsz",this.preview=this.document.createElement("span"),t.appendChild(this.preview);var e=this.handles={tl:this.createHandle("tl"),tm:this.createHandle("tm"),tr:this.createHandle("tr"),lm:this.createHandle("lm"),rm:this.createHandle("rm"),bl:this.createHandle("bl"),bm:this.createHandle("bm"),br:this.createHandle("br")};for(var o in e)t.appendChild(e[o])},createHandle:function(t){var e=this.document.createElement("i");return e.classList.add(t),e},isHandle:function(t){var e=this.handles;for(var o in e)if(e[o]===t)return!0;return!1},show:function(t){this.el=t,this.cfg.snapToSize&&(this.otherImages=n(this.document.getElementsByTagName("img")),this.otherImages.splice(this.otherImages.indexOf(t),1));var e=this.box=s(this.window,t);r(this.container,e.left,e.top),this.document.body.appendChild(this.container),this.el.classList.add("ckimgrsz"),this.showHandles()},hide:function(){for(var t=this.document.getElementsByClassName("ckimgrsz"),e=0;e<t.length;++e)t[e].classList.remove("ckimgrsz");this.hideHandles(),this.container.parentNode&&this.container.parentNode.removeChild(this.container)},initDrag:function(t){if(0===t.button){var e=this,n=new o(this.window,this.document);n.onStart=function(){e.showPreview(),e.isDragging=!0,e.editor.getSelection().lock()},n.onDrag=function(){e.calculateSize(this),e.updatePreview();var t=e.previewBox;e.updateHandles(t,t.left,t.top)},n.onRelease=function(){e.isDragging=!1,e.hidePreview(),e.hide(),e.editor.getSelection().unlock(),e.editor.fire("saveSnapshot")},n.onComplete=function(){e.resizeComplete(),e.editor.fire("saveSnapshot")},n.start(t)}},updateHandles:function(t,e,o){e=e||0,o=o||0;var n=this.handles;r(n.tl,-3+e,-3+o),r(n.tm,Math.round(t.width/2)-3+e,-3+o),r(n.tr,t.width-4+e,-3+o),r(n.lm,-3+e,Math.round(t.height/2)-3+o),r(n.rm,t.width-4+e,Math.round(t.height/2)-3+o),r(n.bl,-3+e,t.height-4+o),r(n.bm,Math.round(t.width/2)-3+e,t.height-4+o),r(n.br,t.width-4+e,t.height-4+o)},showHandles:function(){var t=this.handles;this.updateHandles(this.box);for(var e in t)t[e].style.display="block"},hideHandles:function(){var t=this.handles;for(var e in t)t[e].style.display="none"},showPreview:function(){this.preview.style.backgroundImage='url("'+this.el.src+'")',this.calculateSize(),this.updatePreview(),this.preview.style.display="block"},updatePreview:function(){var t=this.previewBox;r(this.preview,t.left,t.top),a(this.preview,t.width,t.height)},hidePreview:function(){var t=s(this.window,this.preview);this.result={width:t.width,height:t.height},this.preview.style.display="none"},calculateSize:function(t){var e=this.previewBox={top:0,left:0,width:this.box.width,height:this.box.height};if(t){var o=t.target.className;if(~o.indexOf("r")&&(e.width=Math.max(32,this.box.width+t.delta.x)),~o.indexOf("b")&&(e.height=Math.max(32,this.box.height+t.delta.y)),~o.indexOf("l")&&(e.width=Math.max(32,this.box.width-t.delta.x)),~o.indexOf("t")&&(e.height=Math.max(32,this.box.height-t.delta.y)),o.indexOf("m")<0&&!t.keys.shift){var n=this.box.width/this.box.height;e.width/e.height>n?e.height=Math.round(e.width/n):e.width=Math.round(e.height*n)}var i=this.cfg.snapToSize;if(i)for(var r=this.otherImages,a=0;a<r.length;a++){var l=s(this.window,r[a]);if(Math.abs(e.width-l.width)<=i&&Math.abs(e.height-l.height)<=i){e.width=l.width,e.height=l.height;break}}~o.indexOf("l")&&(e.left=this.box.width-e.width),~o.indexOf("t")&&(e.top=this.box.height-e.height)}},resizeComplete:function(){a(this.el,this.result.width,this.result.height)}},o.prototype={start:function(t){t.preventDefault(),t.stopPropagation(),this.target=t.target,this.attr=t.target.className,this.startPos={x:t.clientX,y:t.clientY},this.update(t);var e=this.events;this.document.addEventListener("mousemove",e.mousemove,!1),this.document.addEventListener("keydown",e.keydown,!1),this.document.addEventListener("mouseup",e.mouseup,!1),this.document.body.classList.add("dragging-"+this.attr),this.onStart&&this.onStart()},update:function(t){this.currentPos={x:t.clientX,y:t.clientY},this.delta={x:t.clientX-this.startPos.x,y:t.clientY-this.startPos.y},this.keys={shift:t.shiftKey,ctrl:t.ctrlKey,alt:t.altKey}},mousemove:function(t){this.update(t),this.onDrag&&this.onDrag(),0===t.which&&this.mouseup(t)},keydown:function(t){27===t.keyCode&&this.release()},mouseup:function(t){this.update(t),this.release(),this.onComplete&&this.onComplete()},release:function(){this.document.body.classList.remove("dragging-"+this.attr);var t=this.events;this.document.removeEventListener("mousemove",t.mousemove,!1),this.document.removeEventListener("keydown",t.keydown,!1),this.document.removeEventListener("mouseup",t.mouseup,!1),this.onRelease&&this.onRelease()}}}(),function(){"use strict";var t=CKEDITOR.env.ie;CKEDITOR.plugins.get("dropimages")||CKEDITOR.plugins.add("dropimages",{init:function(t){var e;e=t.editable(t.element.$),e.attachListener(e,"dragenter",this._onDragEnter,this,{editor:t}),e.attachListener(e,"dragover",this._onDragOver,this,{editor:t}),e.attachListener(e,"drop",this._onDragDrop,this,{editor:t})},_handleFiles:function(t,e){var o,n,i;for(o=0;o<t.length;o++)i=t[o],n=/image.*/,i.type.match(n)&&this._processFile(i,e);return!1},_onDragEnter:function(e){t&&this._preventEvent(e)},_onDragOver:function(e){t&&this._preventEvent(e)},_onDragDrop:function(t){var e,o;o=t.data.$,new CKEDITOR.dom.event(o).preventDefault(),e=t.listenerData.editor,t.listenerData.editor.createSelectionFromPoint(o.clientX,o.clientY),this._handleFiles(o.dataTransfer.files,e)},_preventEvent:function(t){t=new CKEDITOR.dom.event(t.data.$),t.preventDefault(),t.stopPropagation()},_processFile:function(t,e){var o=new FileReader;o.addEventListener("loadend",function(){var n,i,r;n=o.result,i=CKEDITOR.dom.element.createFromHtml('<img src="'+n+'">'),e.insertElement(i),r={el:i,file:t},e.fire("imagedrop",r)}),o.readAsDataURL(t)}})}(),function(){"use strict";CKEDITOR.plugins.get("placeholder")||CKEDITOR.plugins.add("placeholder",{init:function(t){t.on("blur",this._onBlur,this)},_onBlur:function(t){var e,o;e=t.editor,""===e.getData()&&(o=new CKEDITOR.dom.element(e.element.$),o.setHtml(""),o.addClass(e.config.placeholderClass))}})}(),function(){function t(t){return CKEDITOR.env.ie?t.$.clientWidth:parseInt(t.getComputedStyle("width"),10)}function e(t,e){var o=t.getComputedStyle("border-"+e+"-width"),n={thin:"0px",medium:"1px",thick:"2px"};return o.indexOf("px")<0&&(o=o in n&&"none"!=t.getComputedStyle("border-style")?n[o]:0),parseInt(o,10)}function o(t){for(var e,o,n,i=t.$.rows,r=0,a=0,s=i.length;s>a;a++)n=i[a],e=n.cells.length,e>r&&(r=e,o=n);return o}function n(t){for(var n=[],i=-1,r="rtl"===t.getComputedStyle("direction"),a=o(t),s=new CKEDITOR.dom.element(t.$.tBodies[0]),l=s.getDocumentPosition(),c=0,d=a.cells.length;d>c;c++){var u=new CKEDITOR.dom.element(a.cells[c]),m=a.cells[c+1]&&new CKEDITOR.dom.element(a.cells[c+1]);i+=u.$.colSpan||1;var p,h,g,y=u.getDocumentPosition().x;r?h=y+e(u,"left"):p=y+u.$.offsetWidth-e(u,"right"),m?(y=m.getDocumentPosition().x,r?p=y+m.$.offsetWidth-e(m,"right"):h=y+e(m,"left")):(y=t.getDocumentPosition().x,r?p=y:h=y+t.$.offsetWidth),g=Math.max(h-p,4),n.push({table:t,index:i,x:p,y:l.y,width:g,height:s.$.offsetHeight,rtl:r})}return n}function i(t,e){for(var o=0,n=t.length;n>o;o++){var i=t[o];if(e>=i.x&&e<=i.x+i.width)return i}return null}function r(t){(t.data||t).preventDefault()}function a(o){function n(){m=null,f=0,g=0,p.removeListener("mouseup",d),h.removeListener("mousedown",c),h.removeListener("mousemove",u),p.getBody().setStyle("cursor","auto")}function i(){for(var e=m.index,o=CKEDITOR.tools.buildTableMap(m.table),n=[],i=[],a=Number.MAX_VALUE,s=a,l=m.rtl,c=0,d=o.length;d>c;c++){var R=o[c],T=R[e+(l?1:0)],I=R[e+(l?0:1)];T=T&&new CKEDITOR.dom.element(T),I=I&&new CKEDITOR.dom.element(I),T&&I&&T.equals(I)||(T&&(a=Math.min(a,t(T))),I&&(s=Math.min(s,t(I))),n.push(T),i.push(I))}E=n,v=i,b=m.x-a,C=m.x+s,h.setOpacity(.5),y=parseInt(h.getStyle("left"),10),f=0,g=1,h.on("mousemove",u),p.on("dragstart",r)}function a(){g=0,h.setOpacity(0),f&&s();var t=m.table;setTimeout(function(){t.removeCustomData("_cke_table_pillars")},0),p.removeListener("dragstart",r)}function s(){for(var o=m.rtl,n=o?v.length:E.length,i=0;n>i;i++){var r=E[i],a=v[i],s=m.table;CKEDITOR.tools.setTimeout(function(t,e,n,i,r,a){t&&t.setStyle("width",l(Math.max(e+a,1))),n&&n.setStyle("width",l(Math.max(i-a,1))),r&&s.setStyle("width",l(r+a*(o?-1:1)))},0,this,[r,r&&t(r),a,a&&t(a),(!r||!a)&&t(s)+e(s,"left")+e(s,"right"),f])}}function c(t){r(t),i(),p.on("mouseup",d,this)}function d(t){t.removeListener(),a()}function u(t){R(t.data.getPageOffset().x)}var m,p,h,g,y,f,E,v,b,C;p=o.document,h=CKEDITOR.dom.element.createFromHtml('<div data-cke-temp=1 contenteditable=false unselectable=on style="position:absolute;cursor:col-resize;filter:alpha(opacity=0);opacity:0;padding:0;background-color:#004;background-image:none;border:0px none;z-index:10"></div>',p),o.on("destroy",function(){h.remove()}),p.getDocumentElement().append(h),this.attachTo=function(t){g||(m=t,h.setStyles({width:l(t.width),height:l(t.height),left:l(t.x),top:l(t.y)}),h.on("mousedown",c,this),p.getBody().setStyle("cursor","col-resize"),h.show())};var R=this.move=function(t){if(!m)return 0;if(!g&&(t<m.x||t>m.x+m.width))return n(),0;var e=t-Math.round(h.$.offsetWidth/2);if(g){if(e===b||e===C)return 1;e=Math.max(e,b),e=Math.min(e,C),f=e-y}return h.setStyle("left",l(e)),1}}function s(t){var e=t.data.getTarget();if("mouseout"===t.name){if(!e.is("table"))return;for(var o=new CKEDITOR.dom.element(t.data.$.relatedTarget||t.data.$.toElement);o&&o.$&&!o.equals(e)&&!o.is("body");)o=o.getParent();if(!o||o.equals(e))return}e.getAscendant("table",1).removeCustomData("_cke_table_pillars"),t.removeListener()}var l=CKEDITOR.tools.cssLength;CKEDITOR.plugins.add("tableresize",{requires:"tabletools",init:function(t){t.on("contentDom",function(){var e,o=t.editable();o.attachListener(o.isInline()?o:t.document,"mousemove",function(o){o=o.data;var l=o.getTarget();if(l.type===CKEDITOR.NODE_ELEMENT){var c=o.getPageOffset().x;if(e&&e.move(c))return void r(o);var d,u;if((l.is("table")||l.getAscendant("tbody",1))&&(d=l.getAscendant("table",1),t.editable().contains(d))){(u=d.getCustomData("_cke_table_pillars"))||(d.setCustomData("_cke_table_pillars",u=n(d)),d.on("mouseout",s),d.on("mousedown",s));var m=i(u,c);m&&(!e&&(e=new a(t)),e.attachTo(m))}}})})}})}(),function(){function t(t){function e(t){n.length>0||t.type==CKEDITOR.NODE_ELEMENT&&f.test(t.getName())&&!t.getCustomData("selected_cell")&&(CKEDITOR.dom.element.setMarker(i,t,"selected_cell",!0),n.push(t))}for(var o=t.getRanges(),n=[],i={},r=0;r<o.length;r++){var a=o[r];if(a.collapsed){var s=a.getCommonAncestor(),l=s.getAscendant("td",!0)||s.getAscendant("th",!0);l&&n.push(l)}else{var c,d=new CKEDITOR.dom.walker(a);for(d.guard=e;c=d.next();)if(c.type!=CKEDITOR.NODE_ELEMENT||!c.is(CKEDITOR.dtd.table)){var u=c.getAscendant("td",!0)||c.getAscendant("th",!0);u&&!u.getCustomData("selected_cell")&&(CKEDITOR.dom.element.setMarker(i,u,"selected_cell",!0),n.push(u))}}}return CKEDITOR.dom.element.clearAllMarkers(i),n}function e(t){for(var e,o,n,i=0,r=t.length-1,a={};e=t[i++];)CKEDITOR.dom.element.setMarker(a,e,"delete_cell",!0);for(i=0;e=t[i++];)if((o=e.getPrevious())&&!o.getCustomData("delete_cell")||(o=e.getNext())&&!o.getCustomData("delete_cell"))return CKEDITOR.dom.element.clearAllMarkers(a),o;return CKEDITOR.dom.element.clearAllMarkers(a),n=t[0].getParent(),(n=n.getPrevious())?n.getLast():(n=t[r].getParent(),(n=n.getNext())?n.getChild(0):null)}function o(e,o){for(var n=t(e),i=n[0],r=i.getAscendant("table"),a=i.getDocument(),s=n[0].getParent(),l=s.$.rowIndex,c=n[n.length-1],d=c.getParent().$.rowIndex+c.$.rowSpan-1,u=new CKEDITOR.dom.element(r.$.rows[d]),m=o?l:d,p=o?s:u,h=CKEDITOR.tools.buildTableMap(r),g=h[m],y=o?h[m-1]:h[m+1],f=h[0].length,E=a.createElement("tr"),v=0;g[v]&&f>v;v++){var b;g[v].rowSpan>1&&y&&g[v]==y[v]?(b=g[v],b.rowSpan+=1):(b=new CKEDITOR.dom.element(g[v]).clone(),b.removeAttribute("rowSpan"),b.appendBogus(),E.append(b),b=b.$),v+=b.colSpan-1}o?E.insertBefore(p):E.insertAfter(p)}function n(e){if(e instanceof CKEDITOR.dom.selection){for(var o=t(e),i=o[0],r=i.getAscendant("table"),a=CKEDITOR.tools.buildTableMap(r),s=o[0].getParent(),l=s.$.rowIndex,c=o[o.length-1],d=c.getParent().$.rowIndex+c.$.rowSpan-1,u=[],m=l;d>=m;m++){for(var p=a[m],h=new CKEDITOR.dom.element(r.$.rows[m]),g=0;g<p.length;g++){var y=new CKEDITOR.dom.element(p[g]),f=y.getParent().$.rowIndex;if(1==y.$.rowSpan)y.remove();else if(y.$.rowSpan-=1,f==m){var E=a[m+1];E[g-1]?y.insertAfter(new CKEDITOR.dom.element(E[g-1])):new CKEDITOR.dom.element(r.$.rows[m+1]).append(y,1)}g+=y.$.colSpan-1}u.push(h)}var v=r.$.rows,b=new CKEDITOR.dom.element(v[d+1]||(l>0?v[l-1]:null)||r.$.parentNode);for(m=u.length;m>=0;m--)n(u[m]);return b}return e instanceof CKEDITOR.dom.element&&(r=e.getAscendant("table"),1==r.$.rows.length?r.remove():e.remove()),null}function i(t,e){for(var o=t.getParent(),n=o.$.cells,i=0,r=0;r<n.length;r++){var a=n[r];if(i+=e?1:a.colSpan,a==t.$)break}return i-1}function r(t,e){for(var o=e?1/0:0,n=0;n<t.length;n++){var r=i(t[n],e);(e?o>r:r>o)&&(o=r)}return o}function a(e,o){for(var n=t(e),i=n[0],a=i.getAscendant("table"),s=r(n,1),l=r(n),c=o?s:l,d=CKEDITOR.tools.buildTableMap(a),u=[],m=[],p=d.length,h=0;p>h;h++){u.push(d[h][c]);var g=o?d[h][c-1]:d[h][c+1];m.push(g)}for(h=0;p>h;h++){var y;u[h]&&(u[h].colSpan>1&&m[h]==u[h]?(y=u[h],y.colSpan+=1):(y=new CKEDITOR.dom.element(u[h]).clone(),y.removeAttribute("colSpan"),y.appendBogus(),y[o?"insertBefore":"insertAfter"].call(y,new CKEDITOR.dom.element(u[h])),y=y.$),h+=y.rowSpan-1)}}function s(e){for(var o,n,i=t(e),r=i[0],a=i[i.length-1],s=r.getAscendant("table"),l=CKEDITOR.tools.buildTableMap(s),c=[],d=0,u=l.length;u>d;d++)for(var m=0,p=l[d].length;p>m;m++)l[d][m]==r.$&&(o=m),l[d][m]==a.$&&(n=m);for(d=o;n>=d;d++)for(m=0;m<l.length;m++){var h=l[m],g=new CKEDITOR.dom.element(s.$.rows[m]),y=new CKEDITOR.dom.element(h[d]);y.$&&(1==y.$.colSpan?y.remove():y.$.colSpan-=1,m+=y.$.rowSpan-1,g.$.cells.length||c.push(g))}var f=s.$.rows[0]&&s.$.rows[0].cells,E=new CKEDITOR.dom.element(f[o]||(o?f[o-1]:s.$.parentNode));return c.length==u&&s.remove(),E}function l(t,e){var o=t.getStartElement(),n=o.getAscendant("td",1)||o.getAscendant("th",1);if(n){var i=n.clone();i.appendBogus(),e?i.insertBefore(n):i.insertAfter(n)}}function c(o){if(o instanceof CKEDITOR.dom.selection){for(var n=t(o),i=n[0]&&n[0].getAscendant("table"),r=e(n),a=n.length-1;a>=0;a--)c(n[a]);r?u(r,!0):i&&i.remove()}else if(o instanceof CKEDITOR.dom.element){var s=o.getParent();1==s.getChildCount()?s.remove():o.remove()}}function d(t){var e=t.getBogus();e&&e.remove(),t.trim()}function u(t,e){var o=t.getDocument(),n=CKEDITOR.document;CKEDITOR.env.ie&&10==CKEDITOR.env.version&&(n.focus(),o.focus());var i=new CKEDITOR.dom.range(o);i["moveToElementEdit"+(e?"End":"Start")](t)||(i.selectNodeContents(t),i.collapse(e?!1:!0)),i.select(!0)}function m(t,e,o){var n=t[e];if("undefined"==typeof o)return n;for(var i=0;n&&i<n.length;i++){if(o.is&&n[i]==o.$)return i;if(i==o)return new CKEDITOR.dom.element(n[i])}return o.is?-1:null}function p(t,e){for(var o=[],n=0;n<t.length;n++){var i=t[n];o.push(i[e]),i[e].rowSpan>1&&(n+=i[e].rowSpan-1)}return o}function h(e,o,n){var i,r=t(e);if((o?1!=r.length:r.length<2)||(i=e.getCommonAncestor())&&i.type==CKEDITOR.NODE_ELEMENT&&i.is("table"))return!1;var a,s=r[0],l=s.getAscendant("table"),c=CKEDITOR.tools.buildTableMap(l),u=c.length,p=c[0].length,h=s.getParent().$.rowIndex,g=m(c,h,s);if(o){var y;try{var f=parseInt(s.getAttribute("rowspan"),10)||1,E=parseInt(s.getAttribute("colspan"),10)||1;y=c["up"==o?h-f:"down"==o?h+f:h]["left"==o?g-E:"right"==o?g+E:g]}catch(v){return!1}if(!y||s.$==y)return!1;r["up"==o||"left"==o?"unshift":"push"](new CKEDITOR.dom.element(y))}for(var b=s.getDocument(),C=h,R=0,T=0,I=!n&&new CKEDITOR.dom.documentFragment(b),w=0,_=0;_<r.length;_++){a=r[_];var A=a.getParent(),S=a.getFirst(),D=a.$.colSpan,O=a.$.rowSpan,k=A.$.rowIndex,x=m(c,k,a);if(w+=D*O,T=Math.max(T,x-g+D),R=Math.max(R,k-h+O),!n){if(d(a),a.getChildren().count()){if(k!=C&&S&&(!S.isBlockBoundary||!S.isBlockBoundary({br:1}))){var B=I.getLast(CKEDITOR.dom.walker.whitespaces(!0));!B||B.is&&B.is("br")||I.append("br")}a.moveChildren(I)}_?a.remove():a.setHtml("")}C=k}if(n)return R*T==w;I.moveChildren(s),s.appendBogus(),T>=p?s.removeAttribute("rowSpan"):s.$.rowSpan=R,R>=u?s.removeAttribute("colSpan"):s.$.colSpan=T;var N=new CKEDITOR.dom.nodeList(l.$.rows),K=N.count();for(_=K-1;_>=0;_--){var P=N.getItem(_);P.$.cells.length||(P.remove(),K++)}return s}function g(e,o){var n=t(e);if(n.length>1)return!1;if(o)return!0;var i,r,a,s,l=n[0],c=l.getParent(),d=c.getAscendant("table"),u=CKEDITOR.tools.buildTableMap(d),p=c.$.rowIndex,h=m(u,p,l),g=l.$.rowSpan;if(g>1){r=Math.ceil(g/2),a=Math.floor(g/2),s=p+r;var y,f=new CKEDITOR.dom.element(d.$.rows[s]),E=m(u,s);i=l.clone();for(var v=0;v<E.length;v++){if(y=E[v],y.parentNode==f.$&&v>h){i.insertBefore(new CKEDITOR.dom.element(y));break}y=null}y||f.append(i)}else{a=r=1,f=c.clone(),f.insertAfter(c),f.append(i=l.clone());for(var b=m(u,p),C=0;C<b.length;C++)b[C].rowSpan++}return i.appendBogus(),l.$.rowSpan=r,i.$.rowSpan=a,1==r&&l.removeAttribute("rowSpan"),1==a&&i.removeAttribute("rowSpan"),i}function y(e,o){var n=t(e);if(n.length>1)return!1;if(o)return!0;var i,r,a,s=n[0],l=s.getParent(),c=l.getAscendant("table"),d=CKEDITOR.tools.buildTableMap(c),u=l.$.rowIndex,h=m(d,u,s),g=s.$.colSpan;if(g>1)r=Math.ceil(g/2),a=Math.floor(g/2);else{a=r=1;for(var y=p(d,h),f=0;f<y.length;f++)y[f].colSpan++}return i=s.clone(),i.insertAfter(s),i.appendBogus(),s.$.colSpan=r,i.$.colSpan=a,1==r&&s.removeAttribute("colSpan"),1==a&&i.removeAttribute("colSpan"),i}if(!CKEDITOR.plugins.tabletools){var f=/^(?:td|th)$/;CKEDITOR.plugins.tabletools={init:function(e){function i(t){return CKEDITOR.tools.extend(t||{},{contextSensitive:1,refresh:function(t,e){this.setState(e.contains({td:1,th:1},1)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED)}})}function r(t,o){var n=e.addCommand(t,o);e.addFeature(n)}var d=e.lang.table;r("cellProperties",new CKEDITOR.dialogCommand("cellProperties",i({allowedContent:"td th{width,height,border-color,background-color,white-space,vertical-align,text-align}[colspan,rowspan]",requiredContent:"table"}))),CKEDITOR.dialog.add("cellProperties",this.path+"dialogs/tableCell.js"),r("rowDelete",i({requiredContent:"table",exec:function(t){var e=t.getSelection();u(n(e))}})),r("rowInsertBefore",i({requiredContent:"table",exec:function(t){var e=t.getSelection();o(e,!0)}})),r("rowInsertAfter",i({requiredContent:"table",exec:function(t){var e=t.getSelection();o(e)}})),r("columnDelete",i({requiredContent:"table",exec:function(t){var e=t.getSelection(),o=s(e);o&&u(o,!0)}})),r("columnInsertBefore",i({requiredContent:"table",exec:function(t){var e=t.getSelection();a(e,!0)}})),r("columnInsertAfter",i({requiredContent:"table",exec:function(t){var e=t.getSelection();a(e)}})),r("cellDelete",i({requiredContent:"table",exec:function(t){var e=t.getSelection();c(e)}})),r("cellMerge",i({allowedContent:"td[colspan,rowspan]",requiredContent:"td[colspan,rowspan]",exec:function(t){u(h(t.getSelection()),!0)}})),r("cellMergeRight",i({allowedContent:"td[colspan]",requiredContent:"td[colspan]",exec:function(t){u(h(t.getSelection(),"right"),!0)}})),r("cellMergeDown",i({allowedContent:"td[rowspan]",requiredContent:"td[rowspan]",exec:function(t){u(h(t.getSelection(),"down"),!0)}})),r("cellVerticalSplit",i({allowedContent:"td[rowspan]",requiredContent:"td[rowspan]",exec:function(t){u(g(t.getSelection()))
}})),r("cellHorizontalSplit",i({allowedContent:"td[colspan]",requiredContent:"td[colspan]",exec:function(t){u(y(t.getSelection()))}})),r("cellInsertBefore",i({requiredContent:"table",exec:function(t){var e=t.getSelection();l(e,!0)}})),r("cellInsertAfter",i({requiredContent:"table",exec:function(t){var e=t.getSelection();l(e)}})),e.addMenuItems&&e.addMenuItems({tablecell:{label:d.cell.menu,group:"tablecell",order:1,getItems:function(){var o=e.getSelection(),n=t(o);return{tablecell_insertBefore:CKEDITOR.TRISTATE_OFF,tablecell_insertAfter:CKEDITOR.TRISTATE_OFF,tablecell_delete:CKEDITOR.TRISTATE_OFF,tablecell_merge:h(o,null,!0)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,tablecell_merge_right:h(o,"right",!0)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,tablecell_merge_down:h(o,"down",!0)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,tablecell_split_vertical:g(o,!0)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,tablecell_split_horizontal:y(o,!0)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,tablecell_properties:n.length>0?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED}}},tablecell_insertBefore:{label:d.cell.insertBefore,group:"tablecell",command:"cellInsertBefore",order:5},tablecell_insertAfter:{label:d.cell.insertAfter,group:"tablecell",command:"cellInsertAfter",order:10},tablecell_delete:{label:d.cell.deleteCell,group:"tablecell",command:"cellDelete",order:15},tablecell_merge:{label:d.cell.merge,group:"tablecell",command:"cellMerge",order:16},tablecell_merge_right:{label:d.cell.mergeRight,group:"tablecell",command:"cellMergeRight",order:17},tablecell_merge_down:{label:d.cell.mergeDown,group:"tablecell",command:"cellMergeDown",order:18},tablecell_split_horizontal:{label:d.cell.splitHorizontal,group:"tablecell",command:"cellHorizontalSplit",order:19},tablecell_split_vertical:{label:d.cell.splitVertical,group:"tablecell",command:"cellVerticalSplit",order:20},tablecell_properties:{label:d.cell.title,group:"tablecellproperties",command:"cellProperties",order:21},tablerow:{label:d.row.menu,group:"tablerow",order:1,getItems:function(){return{tablerow_insertBefore:CKEDITOR.TRISTATE_OFF,tablerow_insertAfter:CKEDITOR.TRISTATE_OFF,tablerow_delete:CKEDITOR.TRISTATE_OFF}}},tablerow_insertBefore:{label:d.row.insertBefore,group:"tablerow",command:"rowInsertBefore",order:5},tablerow_insertAfter:{label:d.row.insertAfter,group:"tablerow",command:"rowInsertAfter",order:10},tablerow_delete:{label:d.row.deleteRow,group:"tablerow",command:"rowDelete",order:15},tablecolumn:{label:d.column.menu,group:"tablecolumn",order:1,getItems:function(){return{tablecolumn_insertBefore:CKEDITOR.TRISTATE_OFF,tablecolumn_insertAfter:CKEDITOR.TRISTATE_OFF,tablecolumn_delete:CKEDITOR.TRISTATE_OFF}}},tablecolumn_insertBefore:{label:d.column.insertBefore,group:"tablecolumn",command:"columnInsertBefore",order:5},tablecolumn_insertAfter:{label:d.column.insertAfter,group:"tablecolumn",command:"columnInsertAfter",order:10},tablecolumn_delete:{label:d.column.deleteColumn,group:"tablecolumn",command:"columnDelete",order:15}}),e.contextMenu&&e.contextMenu.addListener(function(t,e,o){var n=o.contains({td:1,th:1},1);return n&&!n.isReadOnly()?{tablecell:CKEDITOR.TRISTATE_OFF,tablerow:CKEDITOR.TRISTATE_OFF,tablecolumn:CKEDITOR.TRISTATE_OFF}:null})},getSelectedCells:t},CKEDITOR.plugins.add("tabletools",CKEDITOR.plugins.tabletools)}}(),CKEDITOR.tools.buildTableMap=function(t){for(var e=t.$.rows,o=-1,n=[],i=0;i<e.length;i++){o++,!n[o]&&(n[o]=[]);for(var r=-1,a=0;a<e[i].cells.length;a++){var s=e[i].cells[a];for(r++;n[o][r];)r++;for(var l=isNaN(s.colSpan)?1:s.colSpan,c=isNaN(s.rowSpan)?1:s.rowSpan,d=0;c>d;d++){n[o+d]||(n[o+d]=[]);for(var u=0;l>u;u++)n[o+d][r+u]=e[i].cells[a]}r+=l-1}}return n},function(){"use strict";window.AlloyEditor={editable:function(t,e){return e=e||{},e.srcNode=t,new AlloyEditor.Core(e)},Buttons:{},Toolbars:{}}}(),function(){"use strict";var t={isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},isBoolean:function(t){return"boolean"==typeof t},isFunction:function(t){return"function"==typeof t},isNull:function(t){return null===t},isNumber:function(t){return"number"==typeof t&&isFinite(t)},isObject:function(e){var o=typeof e;return e&&("object"===o||t.isFunction(e))},isString:function(t){return"string"==typeof t},mix:function(t,e){var o=Object.prototype.hasOwnProperty;for(var n in e)o.call(e,n)&&(t[n]=e[n])},toInt:function(t){return parseInt(t,10)}};AlloyEditor.Lang=t}(),function(){"use strict";var t={extend:function(t,e,o,n){if(!e||!t)throw"extend failed, verify dependencies";var i=e.prototype,r=Object.create(i);return t.prototype=r,r.constructor=t,t.superclass=i,e!==Object&&i.constructor===Object.prototype.constructor&&(i.constructor=e),o&&AlloyEditor.Lang.mix(r,o),n&&AlloyEditor.Lang.mix(t,n),t}};AlloyEditor.OOP=t}(),function(){"use strict";function t(t){this.__config__=t||{},this.__ATTRS__={}}t.prototype={constructor:t,get:function(t){var e=this.constructor.ATTRS[t];if(e){this._isInitialized(t)||this._init(t);var o=this.__ATTRS__[t];return e.getter&&(o=this._callStringOrFunction(e.getter,o)),o}},set:function(t,e){var o=this.constructor.ATTRS[t];o&&(this._isInitialized(t)||this._init(t),o.readOnly||o.writeOnce&&this._isInitialized(t)||(!o.validator||this._callStringOrFunction(o.validator,e))&&(o.setter&&(e=this._callStringOrFunction(o.setter,e)),this.__ATTRS__[t]=e))},_callStringOrFunction:function(t,e){var o=null;return AlloyEditor.Lang.isArray(e)||(e=[e]),AlloyEditor.Lang.isString(t)&&AlloyEditor.Lang.isFunction(this[t])?o=this[t].apply(this,e):AlloyEditor.Lang.isFunction(t)&&(o=t.apply(this,e)),o},_init:function(t){var e,o=this.constructor.ATTRS[t],n=Object.prototype.hasOwnProperty.call(o,"value"),i=Object.prototype.hasOwnProperty.call(this.__config__,t);if(o.valueFn)e=this._callStringOrFunction(o.valueFn,e),this.__ATTRS__[t]=e;else if(o.readOnly)e=o.value;else if(o.writeOnce)if(n)e=o.value;else{if(!i)return;e=this.__config__[t]}else i?e=this.__config__[t]:n&&(e=o.value);if(o.validator&&i&&!this._callStringOrFunction(o.validator,e)){if(!n)return;e=o.value}o.setter&&i&&(e=this._callStringOrFunction(o.setter,e)),this.__ATTRS__[t]=e},_isInitialized:function(t){return Object.prototype.hasOwnProperty.call(this.__ATTRS__,t)}},AlloyEditor.Attribute=t}(),function(){"use strict";function t(e){t.superclass.constructor.call(this,e),this.init(e)}AlloyEditor.OOP.extend(t,AlloyEditor.Attribute,{init:function(t){this._callChain("initializer",t)},destroy:function(){this._callChain("destructor")},_callChain:function(t,e){for(var o=[],n=this.constructor;n;)AlloyEditor.Lang.isFunction(n.prototype[t])&&o.push(n.prototype[t]),n=n.superclass?n.superclass.constructor:null;o=o.reverse(),e=AlloyEditor.Lang.isArray(e)?e:[e];for(var i=0;i<o.length;i++){var r=o[i];r.apply(this,e)}}}),AlloyEditor.Base=t}(),function(){"use strict";var t=[{name:"link",buttons:["linkEdit"],test:function(t){var e=t.editor.get("nativeEditor");return!e.isSelectionEmpty()&&new CKEDITOR.Link(e).getFromSelection()}},{name:"image",buttons:["imageLeft","imageRight"],test:function(t){var e=t.data.selectionData;return e.element&&"img"===e.element.getName()}},{name:"text",buttons:["styles","bold","italic","underline","link","twitter"],test:function(t){var e=t.editor.get("nativeEditor"),o=e.isSelectionEmpty(),n=t.data.selectionData;return!n.element&&n.region&&!o}},{name:"table",buttons:["tableRow","tableColumn","tableCell","tableRemove"],getArrowBoxClasses:function(){return"alloy-editor-arrow-box alloy-editor-arrow-box-bottom"},setPosition:function(t){var e=t.editor.get("nativeEditor"),o=new CKEDITOR.Table(e).getFromSelection(),n=o.getClientRect(),i=this.getDOMNode(),r=i.offsetWidth/2,a=new CKEDITOR.dom.window(window).getScrollPosition(),s=this.getWidgetXYPoint(n.left+n.width/2-a.x,n.top+a.y,CKEDITOR.SELECTION_BOTTOM_TO_TOP);return this.moveToPoint([s[0],s[1]],[n.left+n.width/2-r-a.x,n.top-i.offsetHeight+a.y]),!0},test:function(t){var e=t.editor.get("nativeEditor");return!!new CKEDITOR.Table(e).getFromSelection()}}];AlloyEditor.Selections=t}(),function(){"use strict";var t={applyStyle:function(){if(AlloyEditor.Lang.isFunction(this.isActive)&&AlloyEditor.Lang.isFunction(this.getStyle)){var t=this.props.editor.get("nativeEditor");t.getSelection().lock(),this.isActive()?t.removeStyle(this.getStyle()):t.applyStyle(this.getStyle()),t.getSelection().unlock(),t.fire("actionPerformed",this)}}};AlloyEditor.ButtonActionStyle=t}(),function(){"use strict";var t={propTypes:{command:React.PropTypes.string.isRequired,modifiesSelection:React.PropTypes.bool},execCommand:function(t){var e=this.props.editor.get("nativeEditor");e.execCommand(this.props.command,t),this.props.modifiesSelection&&e.selectionChange(!0),e.fire("actionPerformed",this)}};AlloyEditor.ButtonCommand=t}(),function(){"use strict";var t={getStateClasses:function(){var t="";return AlloyEditor.Lang.isFunction(this.isActive)&&this.isActive()&&(t+="alloy-editor-button-pressed"),AlloyEditor.Lang.isFunction(this.isDisabled)&&this.isDisabled()&&(t+=" alloy-editor-button-disabled"),t}};AlloyEditor.ButtonStateClasses=t}(),function(){"use strict";var t={propTypes:{style:React.PropTypes.object},componentWillMount:function(){this._style=new CKEDITOR.style(this.props.style)},componentWillUnmount:function(){this._style=null},getStyle:function(){return this._style},isActive:function(){var t,e=this.props.editor.get("nativeEditor"),o=e.elementPath();return t=this.getStyle().checkActive(o,e)}};AlloyEditor.ButtonStyle=t}(),function(){"use strict";var t={getToolbarButtons:function(t,e){var o={},n=this.filterExclusive(t.filter(function(t){return t&&(AlloyEditor.Buttons[t]||AlloyEditor.Buttons[t.name])}).map(function(t){return AlloyEditor.Lang.isString(t)?t=AlloyEditor.Buttons[t]:AlloyEditor.Lang.isString(t.name)&&(o[AlloyEditor.Buttons[t.name].key]=t.cfg,t=AlloyEditor.Buttons[t.name]),t})).map(function(t){var n=this.mergeExclusiveProps({editor:this.props.editor,key:t.key,tabKey:t.key,tabIndex:this.props.trigger&&this.props.trigger.props.tabKey===t.key?0:-1,trigger:this.props.trigger},t.key);return n=this.mergeDropdownProps(n,t.key),e&&(n=CKEDITOR.tools.merge(n,e,o[t.key])),React.createElement(t,n)},this);return n}};AlloyEditor.ToolbarButtons=t}(),function(){"use strict";var t={getArrowBoxClasses:function(){var t="alloy-editor-arrow-box";return AlloyEditor.Lang.isFunction(this.getInteractionPoint)&&this.getInteractionPoint()&&(t+=this.getInteractionPoint().direction===CKEDITOR.SELECTION_TOP_TO_BOTTOM?" alloy-editor-arrow-box-top":" alloy-editor-arrow-box-bottom"),t}};AlloyEditor.WidgetArrowBox=t}(),function(){"use strict";var t={componentWillReceiveProps:function(){this.setState({itemDropdown:null})},getInitialState:function(){return{itemDropdown:null}},mergeDropdownProps:function(t,e){return CKEDITOR.tools.merge(t,{expanded:this.state.itemDropdown===e?!0:!1,toggleDropdown:this.toggleDropdown.bind(this,e)})},toggleDropdown:function(t){this.setState({itemDropdown:t!==this.state.itemDropdown?t:null})}};AlloyEditor.WidgetDropdown=t}(),function(){"use strict";var t={cancelExclusive:function(t){this.state.itemExclusive===t&&this.setState({itemExclusive:null})},componentWillReceiveProps:function(){this.setState({itemExclusive:null})},filterExclusive:function(t){return t.filter(function(t){return this.state.itemExclusive?this.state.itemExclusive===t.key?t:void 0:t}.bind(this))},mergeExclusiveProps:function(t,e){return CKEDITOR.tools.merge(t,{cancelExclusive:this.cancelExclusive.bind(this,e),renderExclusive:this.state.itemExclusive===e,requestExclusive:this.requestExclusive.bind(this,e)})},requestExclusive:function(t){this.setState({itemExclusive:t})}};AlloyEditor.WidgetExclusive=t}(),function(){"use strict";var t=1,e=-1,o={propTypes:{circular:React.PropTypes.bool.isRequired,descendants:React.PropTypes.string.isRequired,keys:React.PropTypes.object.isRequired},componentDidMount:function(){this._refresh()},componentDidUpdate:function(){this._refresh()},focus:function(t){(!t||this._isValidTarget(t.target))&&this._descendants&&(this._descendants[this._activeDescendant].focus(),t&&(t.stopPropagation(),t.preventDefault()))},handleKey:function(t){if(this._isValidTarget(t.target)&&this._descendants){var e=this._getDirection(t);e&&(t.stopPropagation(),t.preventDefault(),this._moveFocus(e))}},_getDirection:function(o){var n=0;return this.props.keys&&(this._isValidKey(o.keyCode,this.props.keys.next)&&(n=t),this._isValidKey(o.keyCode,this.props.keys.prev)&&(n=e),o.shifKey&&(n*=-1)),n},_isValidKey:function(t,e){return AlloyEditor.Lang.isArray(e)?-1!==e.indexOf(t):t===e},_isValidTarget:function(t){var e=t.tagName.toLowerCase();return"input"!==e&&"select"!==e&&"textarea"!==e},_moveFocus:function(t){var e=this._descendants.length,o=this._descendants[this._activeDescendant];o.setAttribute("tabIndex",-1),this._activeDescendant+=t,this._activeDescendant=this.props.circular?(this._activeDescendant%e+e)%e:Math.max(Math.min(this._activeDescendant,e-1),0),o=this._descendants[this._activeDescendant],o.setAttribute("tabIndex",0),o.focus()},_refresh:function(){var t=React.findDOMNode(this);if(t){var e=t.querySelectorAll(this.props.descendants);if(this._descendants=Array.prototype.map.call(e,function(t){return t}).sort(function(t,e){return AlloyEditor.Lang.toInt(t.getAttribute("data-tabindex"))>AlloyEditor.Lang.toInt(e.getAttribute("data-tabindex"))}),this._activeDescendant=0,this.props.trigger&&this.props.trigger.isMounted()){var o=this._descendants.indexOf(React.findDOMNode(this.props.trigger));-1!==o&&(this._activeDescendant=o,this.focus())}}}};AlloyEditor.WidgetFocusManager=o}(),function(){"use strict";var t={getInteractionPoint:function(){var t=this.props.editorEvent?this.props.editorEvent.data:null;if(t){var e=t.selectionData,o={x:t.nativeEvent.pageX,y:t.nativeEvent.pageY},n=e.region.direction,i=e.region.endRect,r=e.region.startRect;i&&r&&r.top===i.top&&(n=CKEDITOR.SELECTION_BOTTOM_TO_TOP);var a,s;return o.x&&o.y?(a=this._getXPoint(e,o.x),s=n===CKEDITOR.SELECTION_BOTTOM_TO_TOP?Math.min(o.y,e.region.top):Math.max(o.y,e.region.bottom)):(a=e.region.left+e.region.width/2,s=n===CKEDITOR.SELECTION_TOP_TO_BOTTOM?e.region.bottom:e.region.top),{direction:n,x:a,y:s}}},_getXPoint:function(t,e){var o,n=t.region,i=n.startRect?n.startRect.left:n.left,r=n.endRect?n.endRect.right:n.right;if(e>i&&r>e)o=e;else{var a=Math.abs(i-e),s=Math.abs(r-e);o=s>a?i:r}return o}};AlloyEditor.WidgetInteractionPoint=t}(),function(){"use strict";var t={mixins:[AlloyEditor.WidgetInteractionPoint],propTypes:{gutter:React.PropTypes.object},getDefaultProps:function(){return{gutter:{left:0,top:10}}},cancelAnimation:function(){window.cancelAnimationFrame&&window.cancelAnimationFrame(this._animationFrameId)},getWidgetXYPoint:function(t,e,o){var n=React.findDOMNode(this),i=this.props.gutter;return o===CKEDITOR.SELECTION_TOP_TO_BOTTOM||o===CKEDITOR.SELECTION_BOTTOM_TO_TOP?(t=t-i.left-n.offsetWidth/2,e=o===CKEDITOR.SELECTION_TOP_TO_BOTTOM?e+i.top:e-n.offsetHeight-i.top):(o===CKEDITOR.SELECTION_LEFT_TO_RIGHT||o===CKEDITOR.SELECTION_RIGHT_TO_LEFT)&&(t=o===CKEDITOR.SELECTION_LEFT_TO_RIGHT?t+i.left+n.offsetHeight/2:t-3*n.offsetHeight/2-i.left,e=e-i.top-n.offsetHeight/2),0>t&&(t=0),0>e&&(e=0),[t,e]},isVisible:function(){var t=this.getDOMNode();if(t){var e=new CKEDITOR.dom.element(t);return e.hasClass("alloy-editor-visible")}return!1},moveToPoint:function(t,e){var o=new CKEDITOR.dom.element(this.getDOMNode());o.setStyles({left:t[0]+"px",top:t[1]+"px",opacity:0}),o.removeClass("alloy-editor-invisible"),this._animate(function(){o.addClass("alloy-editor-toolbar-transition alloy-editor-visible"),o.setStyles({left:e[0],top:e[1],opacity:1})})},show:function(){var t=React.findDOMNode(this);if(!this.isVisible()&&t){var e=this.getInteractionPoint();if(e){var o,n,i,r,a=new CKEDITOR.dom.element(t);o=i=a.getStyle("left"),n=r=a.getStyle("top"),r=e.direction===CKEDITOR.SELECTION_TOP_TO_BOTTOM?this.props.selectionData.region.bottom:this.props.selectionData.region.top,this.moveToPoint([i,r],[o,n])}}},updatePosition:function(){var t=this.getInteractionPoint(),e=React.findDOMNode(this);if(t&&e){var o=this.getWidgetXYPoint(t.x,t.y,t.direction),n=new CKEDITOR.dom.element(e);n.setStyles({left:o[0]+"px",top:o[1]+"px"})}},_animate:function(t){window.requestAnimationFrame?this._animationFrameId=window.requestAnimationFrame(t):t()}};AlloyEditor.WidgetPosition=t}(),function(){"use strict";var t=React.createClass({displayName:"ButtonBold",mixins:[AlloyEditor.ButtonStyle,AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonCommand],propTypes:{editor:React.PropTypes.object.isRequired},statics:{key:"bold"},getDefaultProps:function(){return{command:"bold",style:{element:"strong"}}},render:function(){var t="alloy-editor-button "+this.getStateClasses();return React.createElement("button",{className:t,"data-type":"button-bold",onClick:this.execCommand,tabIndex:this.props.tabIndex},React.createElement("span",{className:"alloy-editor-icon-bold"}))}});AlloyEditor.Buttons[t.key]=AlloyEditor.ButtonBold=t}(),function(){"use strict";var t=React.createClass({displayName:"ButtonCameraImage",statics:{key:"cameraImage"},getDefaultProps:function(){return{videoWidth:320}},componentDidMount:function(){React.findDOMNode(this.refs.buttonTakePhoto).focus()},componentWillUnmount:function(){this._stream&&(this._stream.stop(),this._stream=null)},render:function(){var t=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return t.call(navigator,{video:!0,audio:!1},this._handleStreamSuccess,this._handleStreamError),React.createElement("div",{className:"alloy-editor-camera"},React.createElement("video",{ref:"videoContainer"},"Video stream not available."),React.createElement("button",{className:"alloy-editor-camera-shoot",onClick:this.takePhoto,ref:"buttonTakePhoto"},"Take photo"),React.createElement("canvas",{className:"alloy-editor-camera-canvas",ref:"canvasContainer"}))},takePhoto:function(){var t=React.findDOMNode(this.refs.videoContainer),e=React.findDOMNode(this.refs.canvasContainer),o=e.getContext("2d"),n=this._videoHeight,i=this.props.videoWidth;if(i&&n){e.width=i,e.height=n,o.drawImage(t,0,0,i,n);var r=e.toDataURL("image/png"),a=CKEDITOR.dom.element.createFromHtml('<img src="'+r+'">'),s=this.props.editor.get("nativeEditor");s.insertElement(a),this.props.cancelExclusive(),s.fire("actionPerformed",this),s.fire("imageCameraAdd",a)}},_handleStreamError:function(t){window.alert("An error occurred! "+t)},_handleStreamSuccess:function(t){var e=React.findDOMNode(this.refs.videoContainer),o=React.findDOMNode(this.refs.canvasContainer);e.addEventListener("canplay",function(){var t=e.videoHeight/(e.videoWidth/this.props.videoWidth);isNaN(t)&&(t=this.props.videoWidth/(4/3)),e.setAttribute("width",this.props.videoWidth),e.setAttribute("height",t),o.setAttribute("width",this.props.videoWidth),o.setAttribute("height",t),this._videoHeight=t}.bind(this),!1),this._stream=t,navigator.mozGetUserMedia?e.mozSrcObject=t:e.src=(window.URL||window.webkitURL).createObjectURL(t),e.play(),React.findDOMNode(this.refs.buttonTakePhoto).disabled=!1}});AlloyEditor.ButtonCameraImage=t}(),function(){"use strict";var t=React.createClass({displayName:"ButtonCamera",statics:{key:"camera"},render:function(){if(this.props.renderExclusive)return React.createElement(AlloyEditor.ButtonCameraImage,React.__spread({},this.props));var e=!(navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia);return React.createElement("button",{className:"alloy-editor-button","data-type":"button-image-camera",disabled:e,onClick:this.props.requestExclusive.bind(t.key),tabIndex:this.props.tabIndex},React.createElement("span",{className:"alloy-editor-icon-camera"}))}});AlloyEditor.Buttons[t.key]=AlloyEditor.ButtonCamera=t}(),function(){"use strict";var t=React.createClass({displayName:"ButtonCode",mixins:[AlloyEditor.ButtonStyle,AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonActionStyle],statics:{key:"code"},getDefaultProps:function(){return{style:{element:"pre"}}},render:function(){var t="alloy-editor-button "+this.getStateClasses();return React.createElement("button",{className:t,"data-type":"button-code",onClick:this.applyStyle,tabIndex:this.props.tabIndex},React.createElement("span",{className:"alloy-editor-icon-code"}))}});AlloyEditor.Buttons[t.key]=AlloyEditor.ButtonCode=t}(),function(){"use strict";var t=React.createClass({displayName:"ButtonCommandListItem",mixins:[AlloyEditor.ButtonCommand],propTypes:{description:React.PropTypes.string.isRequired,icon:React.PropTypes.string},statics:{key:"buttonCommandListItem"},render:function(){return React.createElement("button",{className:this._getClassName(),onClick:this.execCommand,tabIndex:this.props.tabIndex},this.props.description)},_getClassName:function(){var t="alloy-editor-toolbar-element";return this.props.icon&&(t+=" alloy-editor-icon-"+this.props.icon),t}});AlloyEditor.ButtonCommandListItem=t}(),function(){"use strict";var t=React.createClass({displayName:"ButtonH1",mixins:[AlloyEditor.ButtonStyle,AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonActionStyle],statics:{key:"h1"},getDefaultProps:function(){return{style:{element:"h1"}}},render:function(){var t="alloy-editor-button "+this.getStateClasses();return React.createElement("button",{className:t,"data-type":"button-h1",onClick:this.applyStyle,tabIndex:this.props.tabIndex},React.createElement("span",{className:"alloy-editor-icon-h1"}))}});AlloyEditor.Buttons[t.key]=AlloyEditor.ButtonH1=t}(),function(){"use strict";var t=React.createClass({displayName:"ButtonH2",mixins:[AlloyEditor.ButtonStyle,AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonActionStyle],statics:{key:"h2"},getDefaultProps:function(){return{style:{element:"h2"}}},render:function(){var t="alloy-editor-button "+this.getStateClasses();return React.createElement("button",{className:t,"data-type":"button-h2",onClick:this.applyStyle,tabIndex:this.props.tabIndex},React.createElement("span",{className:"alloy-editor-icon-h2"}))}});AlloyEditor.Buttons[t.key]=AlloyEditor.ButtonH2=t}(),function(){"use strict";var t=React.createClass({displayName:"ButtonHline",mixins:[AlloyEditor.ButtonStyle,AlloyEditor.ButtonCommand],propTypes:{editor:React.PropTypes.object.isRequired},statics:{key:"hline"},getDefaultProps:function(){return{command:"horizontalrule",style:{element:"hr"}}},render:function(){return React.createElement("button",{className:"alloy-editor-button","data-type":"button-hline",onClick:this.execCommand,tabIndex:this.props.tabIndex},React.createElement("span",{className:"alloy-editor-icon-separator"}))}});AlloyEditor.Buttons[t.key]=AlloyEditor.ButtonHline=t}(),function(){"use strict";var t=React.createClass({displayName:"ButtonImageAlignLeft",mixins:[AlloyEditor.ButtonStyle,AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonActionStyle],statics:{key:"imageLeft"},getDefaultProps:function(){return{style:{element:"img",styles:{"float":"left"}}}},render:function(){var t="alloy-editor-button "+this.getStateClasses();return React.createElement("button",{className:t,"data-type":"button-image-align-left",onClick:this.applyStyle,tabIndex:this.props.tabIndex},React.createElement("span",{className:"alloy-editor-icon-align-left"}))}});AlloyEditor.Buttons[t.key]=AlloyEditor.ButtonImageAlignLeft=t}(),function(){"use strict";var t=React.createClass({displayName:"ButtonImageAlignRight",mixins:[AlloyEditor.ButtonStyle,AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonActionStyle],statics:{key:"imageRight"},getDefaultProps:function(){return{style:{element:"img",styles:{"float":"right"}}}},render:function(){var t="alloy-editor-button "+this.getStateClasses();return React.createElement("button",{className:t,"data-type":"button-image-align-right",onClick:this.applyStyle,tabIndex:this.props.tabIndex},React.createElement("span",{className:"alloy-editor-icon-align-right"}))}});AlloyEditor.Buttons[t.key]=AlloyEditor.ButtonImageAlignRight=t}(),function(){"use strict";var t=React.createClass({displayName:"ButtonImage",statics:{key:"image"},render:function(){var t={display:"none"};return React.createElement("div",null,React.createElement("button",{className:"alloy-editor-button","data-type":"button-image",onClick:this.handleClick,tabIndex:this.props.tabIndex},React.createElement("span",{className:"alloy-editor-icon-image"})),React.createElement("input",{onChange:this._onInputChange,ref:"fileInput",style:t,type:"file"}))},handleClick:function(){CKEDITOR.tools.simulate(React.findDOMNode(this.refs.fileInput),"click")},_onInputChange:function(){var t=new FileReader,e=React.findDOMNode(this.refs.fileInput);t.onload=function(t){var o=this.props.editor.get("nativeEditor"),n=CKEDITOR.dom.element.createFromHtml('<img src="'+t.target.result+'">');o.insertElement(n),o.fire("actionPerformed",this);var i={el:n,file:e.files[0]};o.fire("imageAdd",i)}.bind(this),t.readAsDataURL(e.files[0]),e.value=""}});AlloyEditor.Buttons[t.key]=AlloyEditor.ButtonImage=t}(),function(){"use strict";var t=React.createClass({displayName:"ButtonItalic",mixins:[AlloyEditor.ButtonStyle,AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonCommand],propTypes:{editor:React.PropTypes.object.isRequired},statics:{key:"italic"},getDefaultProps:function(){return{command:"italic",style:{element:"em"}}},render:function(){var t="alloy-editor-button "+this.getStateClasses();return React.createElement("button",{className:t,"data-type":"button-italic",onClick:this.execCommand,tabIndex:this.props.tabIndex},React.createElement("span",{className:"alloy-editor-icon-italic"}))}});AlloyEditor.Buttons[t.key]=AlloyEditor.ButtonItalic=t}(),function(){"use strict";var t=13,e=27,o=React.createClass({displayName:"ButtonLinkEdit",statics:{key:"linkEdit"},componentDidMount:function(){window.requestAnimationFrame?window.requestAnimationFrame(this._focusLinkInput):setTimeout(this._focusLinkInput,0)},getInitialState:function(){var t=new CKEDITOR.Link(this.props.editor.get("nativeEditor")).getFromSelection(),e=t?t.getAttribute("href"):"";return{element:t,linkHref:e}},render:function(){var t={opacity:this.state.linkHref?1:0};return React.createElement("div",{className:"alloy-editor-container-edit-link"},React.createElement("button",{"aria-label":"Cancel",className:"alloy-editor-button",disabled:!this.state.element,onClick:this._removeLink},React.createElement("span",{className:"alloy-editor-icon-unlink"})),React.createElement("div",{className:"alloy-editor-container-input"},React.createElement("input",{className:"alloy-editor-input",onChange:this._handleLinkChange,onKeyDown:this._handleKeyDown,placeholder:"Type or paste link here",ref:"linkInput",type:"text",value:this.state.linkHref}),React.createElement("button",{className:"alloy-editor-button alloy-editor-icon-remove",onClick:this._clearLink,style:t})),React.createElement("button",{"aria-label":"Confirm",className:"alloy-editor-button",disabled:!this.state.linkHref,onClick:this._updateLink},React.createElement("span",{className:"alloy-editor-icon-ok"})))},_clearLink:function(){this.setState({linkHref:""})},_focusLinkInput:function(){React.findDOMNode(this.refs.linkInput).focus()},_handleKeyDown:function(o){(o.keyCode===t||o.keyCode===e)&&o.preventDefault(),o.keyCode===t?this._updateLink():o.keyCode===e&&(this.props.cancelExclusive(),this.props.editor.get("nativeEditor").focus())},_handleLinkChange:function(t){this.setState({linkHref:t.target.value})},_removeLink:function(){var t=this.props.editor.get("nativeEditor"),e=new CKEDITOR.Link(t),o=t.getSelection(),n=o.createBookmarks();e.remove(this.state.element),o.selectBookmarks(n),this.props.cancelExclusive(),t.fire("actionPerformed",this)},_updateLink:function(){var t=this.props.editor.get("nativeEditor"),e=new CKEDITOR.Link(t);this.state.linkHref&&(this.state.element?e.update(this.state.linkHref,this.state.element):e.create(this.state.linkHref),t.fire("actionPerformed",this)),this.props.cancelExclusive()}});AlloyEditor.Buttons[o.key]=AlloyEditor.ButtonLinkEdit=o}(),function(){"use strict";var t=React.createClass({displayName:"ButtonLink",mixins:[AlloyEditor.ButtonStateClasses],statics:{key:"link"},isActive:function(){return null!==new CKEDITOR.Link(this.props.editor.get("nativeEditor")).getFromSelection()},render:function(){var e="alloy-editor-button "+this.getStateClasses();return this.props.renderExclusive?React.createElement(AlloyEditor.ButtonLinkEdit,React.__spread({},this.props)):React.createElement("button",{className:e,"data-type":"button-link",onClick:this.props.requestExclusive.bind(t.key),tabIndex:this.props.tabIndex},React.createElement("span",{className:"alloy-editor-icon-link"}))}});AlloyEditor.Buttons[t.key]=AlloyEditor.ButtonLink=t}(),function(){"use strict";var t=React.createClass({displayName:"ButtonOrderedList",mixins:[AlloyEditor.ButtonStyle,AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonCommand],propTypes:{editor:React.PropTypes.object.isRequired},statics:{key:"ol"},getDefaultProps:function(){return{command:"numberedlist",style:{element:"ol"}}},render:function(){var t="alloy-editor-button "+this.getStateClasses();return React.createElement("button",{className:t,"data-type":"button-ol",onClick:this.execCommand,tabIndex:this.props.tabIndex},React.createElement("span",{className:"alloy-editor-icon-numbered-list"}))}});AlloyEditor.Buttons[t.key]=AlloyEditor.ButtonOrderedList=t}(),function(){"use strict";var t=React.createClass({displayName:"ButtonParagraphAlignLeft",mixins:[AlloyEditor.ButtonStyle,AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonActionStyle],statics:{key:"paragraphLeft"},getDefaultProps:function(){return{style:{element:"p",styles:{"text-align":"left"}}}},render:function(){var t="alloy-editor-button "+this.getStateClasses();return React.createElement("button",{className:t,"data-type":"button-paragraph-align-left",onClick:this.applyStyle,tabIndex:this.props.tabIndex},React.createElement("span",{className:"alloy-editor-icon-align-left"}))}});AlloyEditor.Buttons[t.key]=AlloyEditor.ButtonParagraphAlignLeft=t}(),function(){"use strict";var t=React.createClass({displayName:"ButtonParagraphAlignRight",mixins:[AlloyEditor.ButtonStyle,AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonActionStyle],statics:{key:"paragraphRight"},getDefaultProps:function(){return{style:{element:"p",styles:{"text-align":"right"}}}},render:function(){var t="alloy-editor-button "+this.getStateClasses();return React.createElement("button",{className:t,"data-type":"button-paragraph-align-right",onClick:this.applyStyle,tabIndex:this.props.tabIndex},React.createElement("span",{className:"alloy-editor-icon-align-right"}))}});AlloyEditor.Buttons[t.key]=AlloyEditor.ButtonParagraphAlignRight=t}(),function(){"use strict";var t=React.createClass({displayName:"ButtonParagraphCenter",mixins:[AlloyEditor.ButtonStyle,AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonActionStyle],statics:{key:"paragraphCenter"},getDefaultProps:function(){return{style:{element:"p",styles:{"text-align":"center"}}}},render:function(){var t="alloy-editor-button "+this.getStateClasses();return React.createElement("button",{className:t,"data-type":"button-paragraph-center",onClick:this.applyStyle,tabIndex:this.props.tabIndex},React.createElement("span",{className:"alloy-editor-icon-align-center"}))}});AlloyEditor.Buttons[t.key]=AlloyEditor.ButtonParagraphCenter=t}(),function(){"use strict";var t=React.createClass({displayName:"ButtonParagraphJustify",mixins:[AlloyEditor.ButtonStyle,AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonActionStyle],statics:{key:"paragraphJustify"},getDefaultProps:function(){return{style:{element:"p",styles:{"text-align":"justify"}}}},render:function(){var t="alloy-editor-button "+this.getStateClasses();return React.createElement("button",{className:t,"data-type":"button-paragraph-justify",onClick:this.applyStyle,tabIndex:this.props.tabIndex},React.createElement("span",{className:"alloy-editor-icon-align-justified"}))}});AlloyEditor.Buttons[t.key]=AlloyEditor.ButtonParagraphJustify=t}(),function(){"use strict";var t=React.createClass({displayName:"ButtonQuote",mixins:[AlloyEditor.ButtonStyle,AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonCommand],propTypes:{editor:React.PropTypes.object.isRequired},statics:{key:"quote"},getDefaultProps:function(){return{command:"blockquote",style:{element:"blockquote"}}
},render:function(){var t="alloy-editor-button "+this.getStateClasses();return React.createElement("button",{className:t,"data-type":"button-quote",onClick:this.execCommand,tabIndex:this.props.tabIndex},React.createElement("span",{className:"alloy-editor-icon-quote"}))}});AlloyEditor.Buttons[t.key]=AlloyEditor.ButtonQuote=t}(),function(){"use strict";var t=React.createClass({displayName:"ButtonRemoveFormat",mixins:[AlloyEditor.ButtonCommand],propTypes:{editor:React.PropTypes.object.isRequired},statics:{key:"removeFormat"},getDefaultProps:function(){return{command:"removeFormat"}},render:function(){return React.createElement("button",{className:"alloy-editor-button","data-type":"button-removeformat",onClick:this.execCommand,tabIndex:this.props.tabIndex},React.createElement("span",{className:"alloy-editor-icon-removeformat"}))}});AlloyEditor.Buttons[t.key]=AlloyEditor.ButtonRemoveFormat=t}(),function(){"use strict";var t=React.createClass({displayName:"ButtonStrike",mixins:[AlloyEditor.ButtonStyle,AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonCommand],propTypes:{editor:React.PropTypes.object.isRequired},statics:{key:"strike"},getDefaultProps:function(){return{command:"strike",style:{element:"s"}}},render:function(){var t="alloy-editor-button "+this.getStateClasses();return React.createElement("button",{className:t,"data-type":"button-strike",onClick:this.execCommand,tabIndex:this.props.tabIndex},React.createElement("span",{className:"alloy-editor-icon-strike"}))}});AlloyEditor.Buttons[t.key]=AlloyEditor.ButtonStrike=t}(),function(){"use strict";var t=React.createClass({displayName:"ButtonsStylesListHeader",render:function(){return this.props.styles&&this.props.styles.length?React.createElement("span",{className:"alloy-editor-list-header"},this.props.name):null}});AlloyEditor.ButtonsStylesListHeader=t}(),function(){"use strict";var t=React.createClass({displayName:"ButtonStylesListItemRemove",propTypes:{removeBlocks:React.PropTypes.array},statics:{key:"buttonStylesListItemRemove"},getDefaultProps:function(){return{removeBlocks:["h1","h2","h3","h4","h5","h6"]}},render:function(){return React.createElement("button",{className:"alloy-editor-toolbar-element",onClick:this._removeStyles,tabIndex:this.props.tabIndex},"Normal Text")},_removeStyles:function(){var t=this.props.editor.get("nativeEditor");t.execCommand("removeFormat"),this.props.removeBlocks.forEach(function(e){var o=new CKEDITOR.style({element:e});t.removeStyle(o)}),t.fire("actionPerformed",this)}});AlloyEditor.ButtonStylesListItemRemove=t}(),function(){"use strict";var t=React.createClass({displayName:"ButtonStylesListItem",mixins:[AlloyEditor.ButtonStyle,AlloyEditor.ButtonActionStyle],statics:{key:"buttonStylesListItem"},componentWillMount:function(){var t={element:"span",styles:{margin:0}};t=CKEDITOR.tools.merge(t,this.props.style),this._preview=new CKEDITOR.style(t).buildPreview(this.props.name)},render:function(){return React.createElement("button",{className:"alloy-editor-toolbar-element",dangerouslySetInnerHTML:{__html:this._preview},onClick:this._onClick,tabIndex:this.props.tabIndex})},_onClick:function(){this.props.editor.get("nativeEditor").execCommand("removeFormat"),this.applyStyle()}});AlloyEditor.ButtonStylesListItem=t}(),function(){"use strict";var t=React.createClass({displayName:"ButtonStylesList",mixins:[AlloyEditor.WidgetFocusManager],statics:{key:"buttonStylesList"},componentDidMount:function(){React.findDOMNode(this).focus()},componentWillMount:function(){var t=[],e=[],o=[];this.props.styles.forEach(function(n){var i=new CKEDITOR.style(n.style);i.type===CKEDITOR.STYLE_BLOCK?t.push(n):i.type===CKEDITOR.STYLE_INLINE?e.push(n):i.type===CKEDITOR.STYLE_OBJECT&&o.push(n)}),this._blockStyles=t,this._inlineStyles=e,this._objectStyles=o},getDefaultProps:function(){return{circular:!0,descendants:".alloy-editor-toolbar-element",keys:{next:[39,40],prev:[37,38]}}},render:function(){return React.createElement("div",{className:"alloy-editor-dropdown",onFocus:this.focus,onKeyDown:this.handleKey,tabIndex:"0"},React.createElement(AlloyEditor.ButtonStylesListItemRemove,{editor:this.props.editor}),React.createElement(AlloyEditor.ButtonsStylesListHeader,{name:"Block styles",styles:this._blockStyles}),this._renderStylesItems(this._blockStyles),React.createElement(AlloyEditor.ButtonsStylesListHeader,{name:"Inline styles",styles:this._inlineStyles}),this._renderStylesItems(this._inlineStyles),React.createElement(AlloyEditor.ButtonsStylesListHeader,{name:"Object styles",styles:this._objectStyles}),this._renderStylesItems(this._objectStyles))},_renderStylesItems:function(t){var e,o=this.props.editor,n=this.props.trigger;return t&&t.length&&(e=t.map(function(t){return React.createElement(AlloyEditor.ButtonStylesListItem,{key:t.name,editor:o,name:t.name,style:t.style,tabIndex:n&&n.name===t.name?0:-1})})),e}});AlloyEditor.ButtonStylesList=t}(),function(){"use strict";var t=React.createClass({displayName:"ButtonStyles",statics:{key:"styles"},getDefaultProps:function(){return{styles:[{name:"Head 1",style:{element:"h1"}},{name:"Head 2",style:{element:"h2"}},{name:"Big",style:{element:"big"}},{name:"Small",style:{element:"small"}},{name:"Code",style:{element:"code"}}]}},getInitialState:function(){return{expanded:!1}},render:function(){var t="Normal Text";this.props.styles.forEach(function(e){this._checkActive(e.style)&&(t=e.name)}.bind(this));var e;return this.props.expanded&&(e=React.createElement(AlloyEditor.ButtonStylesList,{editor:this.props.editor,styles:this.props.styles,trigger:this.props.trigger})),React.createElement("div",{className:"alloy-editor-container-styles alloy-editor-has-dropdown"},React.createElement("button",{className:"alloy-editor-toolbar-element",onClick:this.props.toggleDropdown,tabIndex:this.props.tabIndex},React.createElement("div",{className:"alloy-editor-container"},React.createElement("span",{className:"alloy-editor-selected-style"},t),React.createElement("span",{className:"alloy-editor-icon-arrow"}))),e)},_checkActive:function(t){var e=this.props.editor.get("nativeEditor");t=CKEDITOR.tools.merge({element:"span"},t);var o=new CKEDITOR.style(t);return o.checkActive(e.elementPath(),e)}});AlloyEditor.Buttons[t.key]=AlloyEditor.ButtonStyles=t}(),function(){"use strict";var t=React.createClass({displayName:"ButtonSubscript",mixins:[AlloyEditor.ButtonStyle,AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonCommand],propTypes:{editor:React.PropTypes.object.isRequired},statics:{key:"subscript"},getDefaultProps:function(){return{command:"subscript",style:{element:"sub"}}},render:function(){var t="alloy-editor-button "+this.getStateClasses();return React.createElement("button",{className:t,"data-type":"button-subscript",onClick:this.execCommand,tabIndex:this.props.tabIndex},React.createElement("span",{className:"alloy-editor-icon-subscript"}))}});AlloyEditor.Buttons[t.key]=AlloyEditor.ButtonSubscript=t}(),function(){"use strict";var t=React.createClass({displayName:"ButtonSuperscript",mixins:[AlloyEditor.ButtonStyle,AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonCommand],propTypes:{editor:React.PropTypes.object.isRequired},statics:{key:"superscript"},getDefaultProps:function(){return{command:"superscript",style:{element:"sup"}}},render:function(){var t="alloy-editor-button "+this.getStateClasses();return React.createElement("button",{className:t,"data-type":"button-superscript",onClick:this.execCommand,tabIndex:this.props.tabIndex},React.createElement("span",{className:"alloy-editor-icon-superscript"}))}});AlloyEditor.Buttons[t.key]=AlloyEditor.ButtonSuperscript=t}(),function(){"use strict";var t=React.createClass({displayName:"ButtonTableCell",statics:{key:"tableCell"},render:function(){return React.createElement("div",{className:"alloy-editor-container alloy-editor-has-dropdown"},React.createElement("button",{className:"alloy-editor-button",onClick:this.props.toggleDropdown,tabIndex:this.props.tabIndex},React.createElement("span",{className:"alloy-editor-icon-cell"})),this._renderDropdown())},_renderActions:function(){var t=this.props.editor,e=[React.createElement(AlloyEditor.ButtonCommandListItem,{command:"cellInsertBefore",description:"Insert cell left",editor:t,key:"cellinsertbefore"}),React.createElement(AlloyEditor.ButtonCommandListItem,{command:"cellInsertAfter",description:"Insert cell right",editor:t,key:"cellinsertafter"}),React.createElement(AlloyEditor.ButtonCommandListItem,{command:"cellDelete",description:"Delete cell",editor:t,key:"celldelete",modifiesSelection:!0}),React.createElement(AlloyEditor.ButtonCommandListItem,{command:"cellMerge",description:"Merge cells",editor:t,key:"cellmerge"}),React.createElement(AlloyEditor.ButtonCommandListItem,{command:"cellMergeDown",description:"Merge cell below",editor:t,key:"cellmergedown"}),React.createElement(AlloyEditor.ButtonCommandListItem,{command:"cellMergeRight",description:"Merge cell right",editor:t,key:"cellmergeright"}),React.createElement(AlloyEditor.ButtonCommandListItem,{command:"cellHorizontalSplit",description:"Split cells horizontally",editor:t,key:"cellsplithorizontal"}),React.createElement(AlloyEditor.ButtonCommandListItem,{command:"cellVerticalSplit",description:"Split cells vertically",editor:t,key:"cellsplitvertical"})];return e},_renderDropdown:function(){return this.props.expanded?React.createElement("div",{className:"alloy-editor-dropdown"},this._renderActions()):null}});AlloyEditor.Buttons[t.key]=AlloyEditor.ButtonTableCell=t}(),function(){"use strict";var t=React.createClass({displayName:"ButtonTableColumn",statics:{key:"tableColumn"},render:function(){return React.createElement("div",{className:"alloy-editor-container alloy-editor-has-dropdown"},React.createElement("button",{className:"alloy-editor-button",onClick:this.props.toggleDropdown,tabIndex:this.props.tabIndex},React.createElement("span",{className:"alloy-editor-icon-column"})),this._renderDropdown())},_renderActions:function(){var t=this.props.editor,e=[React.createElement(AlloyEditor.ButtonCommandListItem,{command:"columnInsertBefore",description:"Insert column left",editor:t,key:"columninsertbefore"}),React.createElement(AlloyEditor.ButtonCommandListItem,{command:"columnInsertAfter",description:"Insert column right",editor:t,key:"columninsertafter"}),React.createElement(AlloyEditor.ButtonCommandListItem,{command:"columnDelete",description:"Delete column",editor:t,key:"columndelete",modifiesSelection:!0})];return e},_renderDropdown:function(){return this.props.expanded?React.createElement("div",{className:"alloy-editor-dropdown"},this._renderActions()):null}});AlloyEditor.Buttons[t.key]=AlloyEditor.ButtonTableColumn=t}(),function(){"use strict";var t=13,e=27,o=React.createClass({displayName:"ButtonTableEdit",propTypes:{cancelExclusive:React.PropTypes.func.isRequired,editor:React.PropTypes.object.isRequired},statics:{key:"tableEdit"},getDefaultProps:function(){return{tableAttributes:{border:1,cellPadding:0,cellSpacing:0,style:"width: 100%"}}},componentDidMount:function(){React.findDOMNode(this.refs.rows).focus()},getInitialState:function(){return{cols:3,rows:3}},_createTable:function(){var t=this.props.editor.get("nativeEditor"),e=new CKEDITOR.Table(t);e.create({attrs:this.props.tableAttributes,cols:this.state.cols,rows:this.state.rows}),this.props.cancelExclusive(),t.fire("actionPerformed",this)},_handleChange:function(t,e){var o={};o[t]=e.target.value,this.setState(o)},_handleKeyDown:function(o){(o.keyCode===t||o.keyCode===e)&&o.preventDefault(),o.keyCode===t?this._createTable():o.keyCode===e&&this.props.cancelExclusive()},render:function(){var t=Date.now(),e=t+"rows",o=t+"cols";return React.createElement("div",{className:"alloy-editor-container-edit-table"},React.createElement("label",{htmlFor:e},"Rows"),React.createElement("div",{className:"alloy-editor-container-input small"},React.createElement("input",{className:"alloy-editor-input",id:e,onChange:this._handleChange.bind(this,"rows"),min:"1",onKeyDown:this._handleKeyDown,placeholder:"Rows",ref:"rows",type:"number",value:this.state.rows})),React.createElement("label",{htmlFor:o},"Cols"),React.createElement("div",{className:"alloy-editor-container-input small"},React.createElement("input",{className:"alloy-editor-input",id:o,onChange:this._handleChange.bind(this,"cols"),min:"1",onKeyDown:this._handleKeyDown,placeholder:"Colums",ref:"cols",type:"number",value:this.state.cols})),React.createElement("button",{"aria-label":"Confirm",className:"alloy-editor-button",onClick:this._createTable},React.createElement("span",{className:"alloy-editor-icon-ok"})))}});AlloyEditor.Buttons[o.key]=AlloyEditor.ButtonTableEdit=o}(),function(){"use strict";var t=React.createClass({displayName:"ButtonTableRemove",statics:{key:"tableRemove"},render:function(){return React.createElement("button",{className:"alloy-editor-button","data-type":"button-table-remove",onClick:this._removeTable,tabIndex:this.props.tabIndex},React.createElement("span",{className:"alloy-editor-icon-close"}))},_removeTable:function(){var t=this.props.editor.get("nativeEditor"),e=new CKEDITOR.Table(t);e.remove(),t.fire("actionPerformed",this)}});AlloyEditor.Buttons[t.key]=AlloyEditor.ButtonTableRemove=t}(),function(){"use strict";var t=React.createClass({displayName:"ButtonTableRow",statics:{key:"tableRow"},render:function(){return React.createElement("div",{className:"alloy-editor-container alloy-editor-has-dropdown"},React.createElement("button",{className:"alloy-editor-button",onClick:this.props.toggleDropdown,tabIndex:this.props.tabIndex},React.createElement("span",{className:"alloy-editor-icon-row"})),this._renderDropdown())},_renderActions:function(){var t=this.props.editor,e=[React.createElement(AlloyEditor.ButtonCommandListItem,{command:"rowInsertBefore",description:"Insert row above",editor:t,key:"rowinsertbefore"}),React.createElement(AlloyEditor.ButtonCommandListItem,{command:"rowInsertAfter",description:"Insert row below",editor:t,key:"rowinsertafter"}),React.createElement(AlloyEditor.ButtonCommandListItem,{command:"rowDelete",description:"Delete row",editor:t,key:"rowdelete",modifiesSelection:!0})];return e},_renderDropdown:function(){return this.props.expanded?React.createElement("div",{className:"alloy-editor-dropdown"},this._renderActions()):null}});AlloyEditor.Buttons[t.key]=AlloyEditor.ButtonTableRow=t}(),function(){"use strict";var t=React.createClass({displayName:"ButtonTable",statics:{key:"table"},render:function(){return this.props.renderExclusive?React.createElement(AlloyEditor.ButtonTableEdit,React.__spread({},this.props)):React.createElement("button",{className:"alloy-editor-button","data-type":"button-table",onClick:this.props.requestExclusive,tabIndex:this.props.tabIndex},React.createElement("span",{className:"alloy-editor-icon-table"}))}});AlloyEditor.Buttons[t.key]=AlloyEditor.ButtonTable=t}(),function(){"use strict";var t=React.createClass({displayName:"ButtonTwitter",mixins:[AlloyEditor.ButtonStateClasses],propTypes:{editor:React.PropTypes.object.isRequired},statics:{key:"twitter"},handleClick:function(){var t=this.props.editor.get("nativeEditor"),e=new CKEDITOR.Link(t);this.isActive()?e.remove(e.getFromSelection()):e.create(this._getHref(),{"class":"alloy-editor-twitter-link",target:"_blank"}),t.fire("actionPerformed",this)},isActive:function(){var t=new CKEDITOR.Link(this.props.editor.get("nativeEditor")).getFromSelection();return t&&-1!==t.getAttribute("href").indexOf("twitter.com/intent/tweet")},render:function(){var t="alloy-editor-button "+this.getStateClasses();return React.createElement("button",{className:t,"data-type":"button-twitter",onClick:this.handleClick,tabIndex:this.props.tabIndex},React.createElement("span",{className:"alloy-editor-icon-twitter"}))},_getHref:function(){var t=this.props.editor.get("nativeEditor"),e=t.getSelection().getSelectedText(),o=this.props.url,n=this.props.via,i="https://twitter.com/intent/tweet?text="+e;return o&&(i+="&url="+o),n&&(i+="&via="+n),i}});AlloyEditor.Buttons[t.key]=AlloyEditor.ButtonTwitter=t}(),function(){"use strict";var t=React.createClass({displayName:"ButtonUnorderedlist",mixins:[AlloyEditor.ButtonStyle,AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonCommand],propTypes:{editor:React.PropTypes.object.isRequired},statics:{key:"ul"},getDefaultProps:function(){return{command:"bulletedlist",style:{element:"ul"}}},render:function(){var t="alloy-editor-button "+this.getStateClasses();return React.createElement("button",{className:t,"data-type":"button-ul",onClick:this.execCommand,tabIndex:this.props.tabIndex},React.createElement("span",{className:"alloy-editor-icon-bulleted-list"}))}});AlloyEditor.Buttons[t.key]=AlloyEditor.ButtonUnorderedlist=t}(),function(){"use strict";var t=React.createClass({displayName:"ButtonUnderline",mixins:[AlloyEditor.ButtonStyle,AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonCommand],propTypes:{editor:React.PropTypes.object.isRequired},statics:{key:"underline"},getDefaultProps:function(){return{command:"underline",style:{element:"u"}}},render:function(){var t="alloy-editor-button "+this.getStateClasses();return React.createElement("button",{className:t,"data-type":"button-underline",onClick:this.execCommand,tabIndex:this.props.tabIndex},React.createElement("span",{className:"alloy-editor-icon-underline"}))}});AlloyEditor.Buttons[t.key]=AlloyEditor.ButtonUnderline=t}(),function(){"use strict";var t=React.createClass({displayName:"ToolbarAdd",mixins:[AlloyEditor.WidgetDropdown,AlloyEditor.WidgetExclusive,AlloyEditor.WidgetFocusManager,AlloyEditor.ToolbarButtons,AlloyEditor.WidgetPosition,AlloyEditor.WidgetArrowBox],propTypes:{gutterExclusive:React.PropTypes.object},statics:{key:"add"},getDefaultProps:function(){return{circular:!0,descendants:".alloy-editor-button",gutterExclusive:{left:10,top:0},keys:{next:[38,39],prev:[37,40]}}},componentDidMount:function(){this._updatePosition()},componentDidUpdate:function(){this._updatePosition(),this.props.renderExclusive&&this.focus()},render:function(){var t=this._getButtons(),e=this._getToolbarClassName();return React.createElement("div",{className:e,"data-tabindex":this.props.config.tabIndex||0,onFocus:this.focus,onKeyDown:this.handleKey,tabIndex:"-1"},React.createElement("div",{className:"alloy-editor-container"},t))},_getButtons:function(){var e;return this.props.renderExclusive?e=this.getToolbarButtons(this.props.config.buttons):this.props.selectionData&&this.props.selectionData.region&&(e=React.createElement("button",{className:"alloy-editor-button alloy-editor-button-add",onClick:this.props.requestExclusive.bind(this,t.key)},React.createElement("span",{className:"alloy-editor-icon-add"}))),e},_getToolbarClassName:function(){var t="alloy-editor-toolbar-add";return this.props.renderExclusive&&(t="alloy-editor-toolbar "+this.getArrowBoxClasses()),t},_updatePosition:function(){var t;if(this.props.renderExclusive)this.updatePosition(),this.show();else if(this.props.selectionData&&(t=this.props.selectionData.region),t){var e=React.findDOMNode(this),o=new CKEDITOR.dom.element(e),n=t.startRect||t,i=this.props.editor.get("nativeEditor").editable().getClientRect().left;e.style.left=i-e.offsetWidth-this.props.gutterExclusive.left+"px",e.style.top=t.top-e.offsetHeight/2+n.height/2+"px",e.style.opacity=1,o.removeClass("alloy-editor-arrow-box"),this.cancelAnimation()}}});AlloyEditor.Toolbars[t.key]=AlloyEditor.ToolbarAdd=t}(),function(){"use strict";var t=React.createClass({displayName:"ToolbarStyles",mixins:[AlloyEditor.WidgetDropdown,AlloyEditor.WidgetExclusive,AlloyEditor.WidgetFocusManager,AlloyEditor.ToolbarButtons,AlloyEditor.WidgetPosition,AlloyEditor.WidgetArrowBox],statics:{key:"styles"},componentDidMount:function(){this._updatePosition()},componentDidUpdate:function(){this._updatePosition()},getDefaultProps:function(){return{circular:!0,descendants:".alloy-editor-button, .alloy-editor-toolbar-element",keys:{next:[38,39],prev:[37,40]}}},render:function(){var t=this._getCurrentSelection();if(t){var e;e=AlloyEditor.Lang.isFunction(t.getArrowBoxClasses)?t.getArrowBoxClasses():this.getArrowBoxClasses();var o="alloy-editor-toolbar-styles "+e,n=this.getToolbarButtons(t.buttons,{selectionType:t.name});return React.createElement("div",{className:o,"data-tabindex":this.props.config.tabIndex||0,onFocus:this.focus,onKeyDown:this.handleKey,tabIndex:"-1"},React.createElement("div",{className:"alloy-editor-container"},n))}return!1},_getCurrentSelection:function(){var t,e=this.props.editorEvent?this.props.editorEvent.data:null;return e&&this.props.config.selections.some(function(o){var n=o.test({data:e,editor:this.props.editor});return n&&(t=o),n},this),t},_updatePosition:function(){var t,e=this._getCurrentSelection();e&&AlloyEditor.Lang.isFunction(e.setPosition)&&(t=e.setPosition.call(this,{editor:this.props.editor,editorEvent:this.props.editorEvent,selectionData:this.props.selectionData})),t||(this.updatePosition(),this.show())}});AlloyEditor.Toolbars[t.key]=AlloyEditor.ToolbarStyles=t}(),function(){"use strict";var t=React.createClass({displayName:"UI",mixins:[AlloyEditor.WidgetExclusive,AlloyEditor.WidgetFocusManager],getInitialState:function(){return{hidden:!1}},getDefaultProps:function(){return{circular:!0,descendants:"[class*=alloy-editor-toolbar-]",eventsDelay:0,keys:{next:9}}},componentDidMount:function(){var t=this.props.editor.get("nativeEditor");t.on("editorInteraction",this._onEditorInteraction,this),t.on("actionPerformed",this._onActionPerformed,this),t.on("key",this._onEditorKey,this),this._clickListener=function(t){this._setUIHidden(t.target)}.bind(this),this._keyDownListener=CKEDITOR.tools.debounce(function(){this._setUIHidden(document.activeElement)},this.props.eventsDelay,this),document.addEventListener("click",this._clickListener),document.addEventListener("keydown",this._keyDownListener)},componentWillUnmount:function(){this._clickListener&&document.removeEventListener("click",this._clickListener),this._keyDownListener&&(this._keyDownListener.detach(),document.removeEventListener("keydown",this._keyDownListener))},render:function(){if(this.state.hidden)return null;var t=Object.keys(this.props.toolbars).map(function(t){return AlloyEditor.Toolbars[t]||window[t]});return t=this.filterExclusive(t).map(function(t){var e=this.mergeExclusiveProps({config:this.props.toolbars[t.key],editor:this.props.editor,editorEvent:this.state.editorEvent,key:t.key,selectionData:this.state.selectionData,selections:this.props.selections,trigger:this.state.trigger},t.key);return React.createElement(t,e)}.bind(this)),React.createElement("div",{className:"alloy-editor-toolbars",onKeyDown:this.handleKey},t)},_onActionPerformed:function(t){var e=this.props.editor.get("nativeEditor");e.focus(),this.setState({itemExclusive:null,selectionData:e.getSelectionData(),trigger:t.data})},_onEditorInteraction:function(t){this.setState({editorEvent:t,hidden:!1,itemExclusive:null,selectionData:t.data.selectionData,trigger:null})},_onEditorKey:function(t){var e=t.data.domEvent.$;e.altKey&&121===e.keyCode&&this.focus()},_setUIHidden:function(t){var e=React.findDOMNode(this);if(e){var o=this.props.editor.get("nativeEditor").editable(),n=new CKEDITOR.dom.node(t),i=o.$===t||o.contains(n)||new CKEDITOR.dom.element(e).contains(n);i||this.setState({hidden:!0})}}});AlloyEditor.UI=t}(),function(){"use strict";function t(e){t.superclass.constructor.call(this,e)}AlloyEditor.OOP.extend(t,AlloyEditor.Base,{initializer:function(t){var e=this.get("srcNode"),o=CKEDITOR.inline(e);o.config.allowedContent=this.get("allowedContent"),o.config.toolbars=this.get("toolbars"),o.config.removePlugins=this.get("removePlugins"),o.config.extraPlugins=this.get("extraPlugins"),o.config.placeholderClass=this.get("placeholderClass"),o.config.pasteFromWordRemoveStyles=!1,o.config.pasteFromWordRemoveFontStyles=!1,AlloyEditor.Lang.mix(o.config,t),this._editor=o,this._renderUI()},destructor:function(){React.unmountComponentAtNode(this._editorUIElement),this._editorUIElement.parentNode.removeChild(this._editorUIElement);var t=CKEDITOR.instances[this.get("srcNode")];t&&t.destroy()},_getNativeEditor:function(){return this._editor},_renderUI:function(){var t=document.createElement("div");t.className="alloy-editor-ui";var e=this.get("uiNode")||document.body;AlloyEditor.Lang.isString(e)&&(e=document.getElementById(e)),e.appendChild(t),this._mainUI=React.render(React.createElement(AlloyEditor.UI,{editor:this,eventsDelay:this.get("eventsDelay"),toolbars:this.get("toolbars")}),t),this._editorUIElement=t},_validateAllowedContent:function(t){return AlloyEditor.Lang.isString(t)||AlloyEditor.Lang.isObject(t)||AlloyEditor.Lang.isBoolean(t)},_validateToolbars:function(t){return AlloyEditor.Lang.isObject(t)||AlloyEditor.Lang.isNull(t)}},{ATTRS:{allowedContent:{validator:"_validateAllowedContent",value:!0,writeOnce:!0},eventsDelay:{validator:AlloyEditor.Lang.isNumber,value:100},extraPlugins:{validator:AlloyEditor.Lang.isString,value:"uicore,selectionregion,dragresize,dropimages,placeholder,tabletools,tableresize,autolink",writeOnce:!0},nativeEditor:{getter:"_getNativeEditor",readOnly:!0},placeholderClass:{validator:AlloyEditor.Lang.isString,value:"alloy-editor-placeholder",writeOnce:!0},removePlugins:{validator:AlloyEditor.Lang.isString,value:"contextmenu,toolbar,elementspath,resize,liststyle,link",writeOnce:!0},selections:{validator:AlloyEditor.Lang.isArray,value:AlloyEditor.Selections},srcNode:{writeOnce:!0},toolbars:{validator:"_validateToolbars",value:{add:{buttons:["image","camera","hline","table"],tabIndex:2},styles:{selections:AlloyEditor.Selections,tabIndex:1}}},uiNode:{writeOnce:!0}}}),AlloyEditor.Core=t}())}();